<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" href="./assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" href="./assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" href="./assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
    <link rel="manifest" href="./manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>notebook.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>lecture02 03 crystal basics v2</title>
    <script type="module" crossorigin src="./assets/index-3OIHLLq_.js"></script>
    <link rel="modulepreload" crossorigin href="./assets/preload-helper-g1IWzEZ-.js">
    <link rel="modulepreload" crossorigin href="./assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin href="./assets/react-XTZdWHwa.js">
    <link rel="modulepreload" crossorigin href="./assets/compiler-runtime-QczY1yfQ.js">
    <link rel="modulepreload" crossorigin href="./assets/useEventListener-4mpeqPxW.js">
    <link rel="modulepreload" crossorigin href="./assets/react-dom-BZDtXk6t.js">
    <link rel="modulepreload" crossorigin href="./assets/jsx-runtime-DUsrKwmN.js">
    <link rel="modulepreload" crossorigin href="./assets/Combination-D2HqSOvH.js">
    <link rel="modulepreload" crossorigin href="./assets/clsx-FpJB9huX.js">
    <link rel="modulepreload" crossorigin href="./assets/cn-Cs2e4A8T.js">
    <link rel="modulepreload" crossorigin href="./assets/menu-items-B57SjdWM.js">
    <link rel="modulepreload" crossorigin href="./assets/hotkeys-Dh4gy4JD.js">
    <link rel="modulepreload" crossorigin href="./assets/button-D8mnDDLX.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-Dj-O1Spr.js">
    <link rel="modulepreload" crossorigin href="./assets/createLucideIcon-BJ2I6csQ.js">
    <link rel="modulepreload" crossorigin href="./assets/check-CWbw3kKW.js">
    <link rel="modulepreload" crossorigin href="./assets/select-CgZgQ5hV.js">
    <link rel="modulepreload" crossorigin href="./assets/multi-map-D3NvLiI9.js">
    <link rel="modulepreload" crossorigin href="./assets/chevron-right-B_qBg_RU.js">
    <link rel="modulepreload" crossorigin href="./assets/dropdown-menu-Ciqx4yT-.js">
    <link rel="modulepreload" crossorigin href="./assets/tooltip-DqNvr2Rw.js">
    <link rel="modulepreload" crossorigin href="./assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin href="./assets/_getTag-BWqNuuwU.js">
    <link rel="modulepreload" crossorigin href="./assets/_baseIsEqual-C8v2yRqO.js">
    <link rel="modulepreload" crossorigin href="./assets/jotai-D74Ef_p1.js">
    <link rel="modulepreload" crossorigin href="./assets/invariant-Amh6wt4N.js">
    <link rel="modulepreload" crossorigin href="./assets/isArrayLikeObject-BkJc8lDE.js">
    <link rel="modulepreload" crossorigin href="./assets/merge-5YNOh9ZD.js">
    <link rel="modulepreload" crossorigin href="./assets/zod-BBqism5D.js">
    <link rel="modulepreload" crossorigin href="./assets/utils-x9KlwLm7.js">
    <link rel="modulepreload" crossorigin href="./assets/requests-THIDPq-F.js">
    <link rel="modulepreload" crossorigin href="./assets/once-BxRirs3K.js">
    <link rel="modulepreload" crossorigin href="./assets/toDate-Y5T6FHPx.js">
    <link rel="modulepreload" crossorigin href="./assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin href="./assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin href="./assets/_baseSlice-BoaxdS7L.js">
    <link rel="modulepreload" crossorigin href="./assets/_hasUnicode-CNlKPr15.js">
    <link rel="modulepreload" crossorigin href="./assets/useLifecycle-8fgb5Nue.js">
    <link rel="modulepreload" crossorigin href="./assets/capitalize-L9-XHPtm.js">
    <link rel="modulepreload" crossorigin href="./assets/ai-model-dropdown-CO52rzQt.js">
    <link rel="modulepreload" crossorigin href="./assets/badge-Cm0WUI-_.js">
    <link rel="modulepreload" crossorigin href="./assets/use-toast-DKTyV2AR.js">
    <link rel="modulepreload" crossorigin href="./assets/constants-BmIIVBf_.js">
    <link rel="modulepreload" crossorigin href="./assets/Deferred-9HYzcD3r.js">
    <link rel="modulepreload" crossorigin href="./assets/config-CbG7e0K6.js">
    <link rel="modulepreload" crossorigin href="./assets/uuid-B8w6pjWV.js">
    <link rel="modulepreload" crossorigin href="./assets/DeferredRequestRegistry-DfLQSvoS.js">
    <link rel="modulepreload" crossorigin href="./assets/connection-B11rCPnY.js">
    <link rel="modulepreload" crossorigin href="./assets/useNonce-D8CLFIrY.js">
    <link rel="modulepreload" crossorigin href="./assets/capabilities-Bdlrhekp.js">
    <link rel="modulepreload" crossorigin href="./assets/createReducer-VgoBNe3M.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-C3a_7WFa.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-0z0sEYV-.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-BzfTz_Dx.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-DmruaXMM.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-DU0YrNRK.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-_bGPtAsk.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-DsSBESho.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-B2TjmP7E.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-BzDb7E9f.js">
    <link rel="modulepreload" crossorigin href="./assets/stex-C4ZxI0N3.js">
    <link rel="modulepreload" crossorigin href="./assets/cjs-Ba5CQnxe.js">
    <link rel="modulepreload" crossorigin href="./assets/_arrayReduce-DdxhySYh.js">
    <link rel="modulepreload" crossorigin href="./assets/type-kFt-n-jZ.js">
    <link rel="modulepreload" crossorigin href="./assets/_baseProperty-D0ckTA0L.js">
    <link rel="modulepreload" crossorigin href="./assets/toNumber-GB_lFVaq.js">
    <link rel="modulepreload" crossorigin href="./assets/now-CAWn5i9V.js">
    <link rel="modulepreload" crossorigin href="./assets/debounce-Bgq-wc7M.js">
    <link rel="modulepreload" crossorigin href="./assets/toInteger-Cl1doThW.js">
    <link rel="modulepreload" crossorigin href="./assets/main-CC_mbgxK.js">
    <link rel="modulepreload" crossorigin href="./assets/cells-DoKM12vd.js">
    <link rel="modulepreload" crossorigin href="./assets/kbd-EdFdwHEs.js">
    <link rel="modulepreload" crossorigin href="./assets/renderShortcut-CLenKJO6.js">
    <link rel="modulepreload" crossorigin href="./assets/useEvent-l9BzRqpK.js">
    <link rel="modulepreload" crossorigin href="./assets/useDeleteCell-BDBSmjLV.js">
    <link rel="modulepreload" crossorigin href="./assets/lazy-Cbg8zRvU.js">
    <link rel="modulepreload" crossorigin href="./assets/defaultLocale-8c1ixjJ_.js">
    <link rel="modulepreload" crossorigin href="./assets/precisionRound-CQhbsDNz.js">
    <link rel="modulepreload" crossorigin href="./assets/defaultLocale-BECdiY5x.js">
    <link rel="modulepreload" crossorigin href="./assets/vega-loader.browser-DZ31-605.js">
    <link rel="modulepreload" crossorigin href="./assets/tooltip-CSAGVmjx.js">
    <link rel="modulepreload" crossorigin href="./assets/ErrorBoundary-6EjkHrSV.js">
    <link rel="modulepreload" crossorigin href="./assets/alert-dialog-D9SwG8oA.js">
    <link rel="modulepreload" crossorigin href="./assets/dialog-BPIq0Dmw.js">
    <link rel="modulepreload" crossorigin href="./assets/useDebounce-C9S6xmGh.js">
    <link rel="modulepreload" crossorigin href="./assets/numbers-BigybruE.js">
    <link rel="modulepreload" crossorigin href="./assets/SSRProvider-DlZbKHsu.js">
    <link rel="modulepreload" crossorigin href="./assets/context-CO64Gasq.js">
    <link rel="modulepreload" crossorigin href="./assets/useNumberFormatter-B5HAJDUq.js">
    <link rel="modulepreload" crossorigin href="./assets/usePress-DHxqjtDm.js">
    <link rel="modulepreload" crossorigin href="./assets/input-CVoLDDk-.js">
    <link rel="modulepreload" crossorigin href="./assets/ImperativeModal-ameyIrhc.js">
    <link rel="modulepreload" crossorigin href="./assets/cell-link-BiAu_8pk.js">
    <link rel="modulepreload" crossorigin href="./assets/alert-D5BMn3Et.js">
    <link rel="modulepreload" crossorigin href="./assets/links-Iv0WhyKW.js">
    <link rel="modulepreload" crossorigin href="./assets/state-i7G4J1VS.js">
    <link rel="modulepreload" crossorigin href="./assets/MarimoErrorOutput-Bh7Bgl2Z.js">
    <link rel="modulepreload" crossorigin href="./assets/copy-BS3uwoaq.js">
    <link rel="modulepreload" crossorigin href="./assets/copy-DhmkXAPp.js">
    <link rel="modulepreload" crossorigin href="./assets/copy-icon-Lyk2_Z8G.js">
    <link rel="modulepreload" crossorigin href="./assets/spinner-DpaQpaiI.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-D1pae9A2.js">
    <link rel="modulepreload" crossorigin href="./assets/focus-CyxSol0W.js">
    <link rel="modulepreload" crossorigin href="./assets/popover-DZBXSGEz.js">
    <link rel="modulepreload" crossorigin href="./assets/useRunCells-DT1En-Te.js">
    <link rel="modulepreload" crossorigin href="./assets/mode-DKDAYLK9.js">
    <link rel="modulepreload" crossorigin href="./assets/purify.es-hXMlfS4W.js">
    <link rel="modulepreload" crossorigin href="./assets/RenderHTML-Dlz0Ew2i.js">
    <link rel="modulepreload" crossorigin href="./assets/table-CesNYRF-.js">
    <link rel="modulepreload" crossorigin href="./assets/tabs-BjAbB8w_.js">
    <link rel="modulepreload" crossorigin href="./assets/add-missing-import-DV1FOw9w.js">
    <link rel="modulepreload" crossorigin href="./assets/useAsyncData-_-DLduEH.js">
    <link rel="modulepreload" crossorigin href="./assets/useIframeCapabilities-r0LQMxAQ.js">
    <link rel="modulepreload" crossorigin href="./assets/LazyAnyLanguageCodeMirror-C7KtNlRp.js">
    <link rel="modulepreload" crossorigin href="./assets/error-banner-C9tkg1MX.js">
    <link rel="modulepreload" crossorigin href="./assets/formats-C3exma5i.js">
    <link rel="modulepreload" crossorigin href="./assets/useTheme-DpA-8Qyy.js">
    <link rel="modulepreload" crossorigin href="./assets/en-US-Lc4gASCJ.js">
    <link rel="modulepreload" crossorigin href="./assets/isValid-Cd_L_2Pm.js">
    <link rel="modulepreload" crossorigin href="./assets/maps-D4abje2p.js">
    <link rel="modulepreload" crossorigin href="./assets/shim-D-ElLTBO.js">
    <link rel="modulepreload" crossorigin href="./assets/download-CCvBQ7qL.js">
    <link rel="modulepreload" crossorigin href="./assets/extends-C2lJEiP_.js">
    <link rel="modulepreload" crossorigin href="./assets/emotion-is-prop-valid.esm-c4A1huxA.js">
    <link rel="modulepreload" crossorigin href="./assets/useDateFormatter-BMdQ9MI_.js">
    <link rel="modulepreload" crossorigin href="./assets/katex-BmfUoCWW.js">
    <link rel="modulepreload" crossorigin href="./assets/marked.esm-idL59iHw.js">
    <link rel="modulepreload" crossorigin href="./assets/chunk-T7OEMACY-CdGEwedE.js">
    <link rel="modulepreload" crossorigin href="./assets/range-Bbli-TEL.js">
    <link rel="modulepreload" crossorigin href="./assets/table-kHJ0xpFt.js">
    <link rel="modulepreload" crossorigin href="./assets/Output-DxdWGPFi.js">
    <link rel="modulepreload" crossorigin href="./assets/name-cell-input-C6ZYU6mN.js">
    <link rel="modulepreload" crossorigin href="./assets/useHotkey-B0ylhc2m.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-CqHWOZu2.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-BcLYYUSi.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-BVXr6b5T.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-BrEX5EQl.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-CalRK9ms.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-Cc4T7UUX.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-D3MC5WiF.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-DgaCIZAa.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-rqHtY98i.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-tj-jaP-y.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-w7c0BKrD.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-CCZcRJI9.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-CrDb6akR.js">
    <link rel="modulepreload" crossorigin href="./assets/apl-BQt6lLuE.js">
    <link rel="modulepreload" crossorigin href="./assets/asciiarmor-BjX7bs0j.js">
    <link rel="modulepreload" crossorigin href="./assets/asn1-xn1MtyoW.js">
    <link rel="modulepreload" crossorigin href="./assets/brainfuck-BjO-UY1i.js">
    <link rel="modulepreload" crossorigin href="./assets/clike-DW9tQWfF.js">
    <link rel="modulepreload" crossorigin href="./assets/clojure-BSW96HRx.js">
    <link rel="modulepreload" crossorigin href="./assets/cmake-C7UlMfz3.js">
    <link rel="modulepreload" crossorigin href="./assets/cobol-CyWIev3Y.js">
    <link rel="modulepreload" crossorigin href="./assets/coffeescript-DTvziYTK.js">
    <link rel="modulepreload" crossorigin href="./assets/commonlisp-yMdkdGMi.js">
    <link rel="modulepreload" crossorigin href="./assets/crystal-BGnoSp3z.js">
    <link rel="modulepreload" crossorigin href="./assets/css-D7fWzevp.js">
    <link rel="modulepreload" crossorigin href="./assets/cypher-Cr1dl0Qf.js">
    <link rel="modulepreload" crossorigin href="./assets/d-C2bS5bA6.js">
    <link rel="modulepreload" crossorigin href="./assets/diff-B2mHQyn6.js">
    <link rel="modulepreload" crossorigin href="./assets/dtd-Cy-lUE7p.js">
    <link rel="modulepreload" crossorigin href="./assets/dylan-mm60grwk.js">
    <link rel="modulepreload" crossorigin href="./assets/ecl-Cqi05Wy1.js">
    <link rel="modulepreload" crossorigin href="./assets/eiffel-FkvfLQq7.js">
    <link rel="modulepreload" crossorigin href="./assets/elm-Da5txHw0.js">
    <link rel="modulepreload" crossorigin href="./assets/erlang-CdnCEH5x.js">
    <link rel="modulepreload" crossorigin href="./assets/simple-mode-B185hCuE.js">
    <link rel="modulepreload" crossorigin href="./assets/factor-CamlR8EJ.js">
    <link rel="modulepreload" crossorigin href="./assets/forth-UcMX0m31.js">
    <link rel="modulepreload" crossorigin href="./assets/fortran-DZ_vNVsP.js">
    <link rel="modulepreload" crossorigin href="./assets/gas-CM88o6Zj.js">
    <link rel="modulepreload" crossorigin href="./assets/gherkin-BhrpTeN9.js">
    <link rel="modulepreload" crossorigin href="./assets/groovy-BFju68Wx.js">
    <link rel="modulepreload" crossorigin href="./assets/haskell-CrWHY4et.js">
    <link rel="modulepreload" crossorigin href="./assets/haxe-1eKW-tbO.js">
    <link rel="modulepreload" crossorigin href="./assets/idl-Do4AwvU2.js">
    <link rel="modulepreload" crossorigin href="./assets/javascript-CTXZKRYd.js">
    <link rel="modulepreload" crossorigin href="./assets/julia-BRynwHI4.js">
    <link rel="modulepreload" crossorigin href="./assets/livescript-ZmIBNA-I.js">
    <link rel="modulepreload" crossorigin href="./assets/lua-mUfZ-MRC.js">
    <link rel="modulepreload" crossorigin href="./assets/mathematica-Dil5dTHO.js">
    <link rel="modulepreload" crossorigin href="./assets/mbox-Dnkn9wSr.js">
    <link rel="modulepreload" crossorigin href="./assets/mirc-auEWieOB.js">
    <link rel="modulepreload" crossorigin href="./assets/mllike-xVJsauJ8.js">
    <link rel="modulepreload" crossorigin href="./assets/modelica-B8kajVDm.js">
    <link rel="modulepreload" crossorigin href="./assets/mscgen-Bsnta1jn.js">
    <link rel="modulepreload" crossorigin href="./assets/mumps-CMw16b5q.js">
    <link rel="modulepreload" crossorigin href="./assets/nsis-DwPdi8sw.js">
    <link rel="modulepreload" crossorigin href="./assets/ntriples-O5lQxirn.js">
    <link rel="modulepreload" crossorigin href="./assets/octave-CMfAar-E.js">
    <link rel="modulepreload" crossorigin href="./assets/oz-CLRI9Qww.js">
    <link rel="modulepreload" crossorigin href="./assets/pascal-D2M_3HBx.js">
    <link rel="modulepreload" crossorigin href="./assets/perl-B8lV7aKt.js">
    <link rel="modulepreload" crossorigin href="./assets/pig-Bima2bfE.js">
    <link rel="modulepreload" crossorigin href="./assets/powershell-v_t41ydu.js">
    <link rel="modulepreload" crossorigin href="./assets/properties-ChrStSby.js">
    <link rel="modulepreload" crossorigin href="./assets/protobuf-Bin6kmlf.js">
    <link rel="modulepreload" crossorigin href="./assets/pug-UWVdYLYW.js">
    <link rel="modulepreload" crossorigin href="./assets/puppet-DYrtWvYn.js">
    <link rel="modulepreload" crossorigin href="./assets/python-BuKrulde.js">
    <link rel="modulepreload" crossorigin href="./assets/q-CrXUTiVN.js">
    <link rel="modulepreload" crossorigin href="./assets/r-Bk2Tiso2.js">
    <link rel="modulepreload" crossorigin href="./assets/rpm-CmmZphz3.js">
    <link rel="modulepreload" crossorigin href="./assets/ruby-ElyOTVeQ.js">
    <link rel="modulepreload" crossorigin href="./assets/sas-jE3ZlG0K.js">
    <link rel="modulepreload" crossorigin href="./assets/scheme-CZF1tRbv.js">
    <link rel="modulepreload" crossorigin href="./assets/shell-LqT3ZqMa.js">
    <link rel="modulepreload" crossorigin href="./assets/sieve-y15yT7Pp.js">
    <link rel="modulepreload" crossorigin href="./assets/smalltalk-pk5PvsMs.js">
    <link rel="modulepreload" crossorigin href="./assets/sparql-DTZ_gfPQ.js">
    <link rel="modulepreload" crossorigin href="./assets/stylus-CrGj0eNT.js">
    <link rel="modulepreload" crossorigin href="./assets/swift-tt3PlBbI.js">
    <link rel="modulepreload" crossorigin href="./assets/tcl-1P4b0GMJ.js">
    <link rel="modulepreload" crossorigin href="./assets/textile-BHDIuMYh.js">
    <link rel="modulepreload" crossorigin href="./assets/toml-C8qoqk_i.js">
    <link rel="modulepreload" crossorigin href="./assets/troff-DMiF5Zmz.js">
    <link rel="modulepreload" crossorigin href="./assets/ttcn-cfg-qLZtNU-E.js">
    <link rel="modulepreload" crossorigin href="./assets/ttcn-BAUp3RZn.js">
    <link rel="modulepreload" crossorigin href="./assets/turtle-BizIwmKv.js">
    <link rel="modulepreload" crossorigin href="./assets/vb-Bn_uCxNL.js">
    <link rel="modulepreload" crossorigin href="./assets/vbscript-BTKW8Atx.js">
    <link rel="modulepreload" crossorigin href="./assets/velocity-CcB05fpi.js">
    <link rel="modulepreload" crossorigin href="./assets/verilog-BWdtOJH8.js">
    <link rel="modulepreload" crossorigin href="./assets/vhdl-CzFOaOHx.js">
    <link rel="modulepreload" crossorigin href="./assets/webidl-DDEKCqSy.js">
    <link rel="modulepreload" crossorigin href="./assets/xquery-BcF6ZhQP.js">
    <link rel="modulepreload" crossorigin href="./assets/yacas-BARQAiXa.js">
    <link rel="modulepreload" crossorigin href="./assets/z80-DO_Ep0iT.js">
    <link rel="modulepreload" crossorigin href="./assets/esm-DnNh7vdQ.js">
    <link rel="modulepreload" crossorigin href="./assets/objectWithoutPropertiesLoose-DDabolgJ.js">
    <link rel="modulepreload" crossorigin href="./assets/esm-Crqxhl3F.js">
    <link rel="modulepreload" crossorigin href="./assets/trash-Df8Wb7xS.js">
    <link rel="modulepreload" crossorigin href="./assets/ConsoleOutput-D8ETq-cc.js">
    <link rel="modulepreload" crossorigin href="./assets/icons-BgmgMjOV.js">
    <link rel="modulepreload" crossorigin href="./assets/blob-LiDbeYko.js">
    <link rel="modulepreload" crossorigin href="./assets/add-cell-with-ai-85tnyxYo.js">
    <link rel="modulepreload" crossorigin href="./assets/chart-no-axes-column-BrQ3B3xc.js">
    <link rel="modulepreload" crossorigin href="./assets/square-function-D5EEjILG.js">
    <link rel="modulepreload" crossorigin href="./assets/spec-DpllSlJD.js">
    <link rel="modulepreload" crossorigin href="./assets/useInstallPackage-BaAhpZlP.js">
    <link rel="modulepreload" crossorigin href="./assets/column-preview-DGBk0umL.js">
    <link rel="modulepreload" crossorigin href="./assets/useAddCell-DYfGo4T8.js">
    <link rel="modulepreload" crossorigin href="./assets/toggle-PGHtwx2G.js">
    <link rel="modulepreload" crossorigin href="./assets/api-CoLss8_O.js">
    <link rel="modulepreload" crossorigin href="./assets/globals-oV9pRUSB.js">
    <link rel="modulepreload" crossorigin href="./assets/share-DjbnD3WE.js">
    <link rel="modulepreload" crossorigin href="./assets/memoize-DN0TMY36.js">
    <link rel="modulepreload" crossorigin href="./assets/get-CyLJYAfP.js">
    <link rel="modulepreload" crossorigin href="./assets/_baseSet-CKSmZC_I.js">
    <link rel="modulepreload" crossorigin href="./assets/utilities.esm-DvrcU9Ky.js">
    <link rel="modulepreload" crossorigin href="./assets/floating-outline-DmCT2Mvg.js">
    <link rel="modulepreload" crossorigin href="./assets/eye-off-BUwXWtH0.js">
    <link rel="modulepreload" crossorigin href="./assets/plus-CiGrWbgb.js">
    <link rel="modulepreload" crossorigin href="./assets/readonly-python-code-CkaJ4Tks.js">
    <link rel="modulepreload" crossorigin href="./assets/file-video-camera-BGBfFNDn.js">
    <link rel="modulepreload" crossorigin href="./assets/file-text-O5IflCIn.js">
    <link rel="modulepreload" crossorigin href="./assets/file-CqXxt3_J.js">
    <link rel="modulepreload" crossorigin href="./assets/types-BMriRmf-.js">
    <link rel="modulepreload" crossorigin href="./assets/label-4Nancvon.js">
    <link rel="modulepreload" crossorigin href="./assets/textarea-BnZHy5Jt.js">
    <link rel="modulepreload" crossorigin href="./assets/circle-x-Cc9X6U_B.js">
    <link rel="modulepreload" crossorigin href="./assets/refresh-ccw-aU2rUkrI.js">
    <link rel="modulepreload" crossorigin href="./assets/trash-2-Du5ITnDv.js">
    <link rel="modulepreload" crossorigin href="./assets/form-600t_Civ.js">
    <link rel="modulepreload" crossorigin href="./assets/field-Dov6YyOV.js">
    <link rel="modulepreload" crossorigin href="./assets/switch-Ct8mUApv.js">
    <link rel="modulepreload" crossorigin href="./assets/useBoolean-Dmwks1uh.js">
    <link rel="modulepreload" crossorigin href="./assets/useDeepCompareMemoize-C8RdAYFq.js">
    <link rel="modulepreload" crossorigin href="./assets/types-D0WVpW93.js">
    <link rel="modulepreload" crossorigin href="./assets/prop-types-WJwGTMoZ.js">
    <link rel="modulepreload" crossorigin href="./assets/es-DAmFxw3U.js">
    <link rel="modulepreload" crossorigin href="./assets/VisuallyHidden-RqykLBKh.js">
    <link rel="modulepreload" crossorigin href="./assets/_baseFlatten-rM2FaX4x.js">
    <link rel="modulepreload" crossorigin href="./assets/hasIn-CE-pxQP-.js">
    <link rel="modulepreload" crossorigin href="./assets/_basePickBy-LbasZ8ix.js">
    <link rel="modulepreload" crossorigin href="./assets/pick-FbHfDtcJ.js">
    <link rel="modulepreload" crossorigin href="./assets/send-LAFRRDPT.js">
    <link rel="modulepreload" crossorigin href="./assets/code-xml-DdSOsi73.js">
    <link rel="modulepreload" crossorigin href="./assets/download-Dmmu2U4a.js">
    <link rel="modulepreload" crossorigin href="./assets/globe-vMZtva7z.js">
    <link rel="modulepreload" crossorigin href="./assets/refresh-cw-BOc7UXm9.js">
    <link rel="modulepreload" crossorigin href="./assets/settings-DznrHqbd.js">
    <link rel="modulepreload" crossorigin href="./assets/square-DhlBDqyx.js">
    <link rel="modulepreload" crossorigin href="./assets/triangle-alert-Bf1kg4xT.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-DL3W3q-2.js">
    <link rel="modulepreload" crossorigin href="./assets/bundle.esm-C-9IAWQU.js">
    <link rel="stylesheet" crossorigin href="./assets/cells-wU8qigWB.css">
    <link rel="stylesheet" crossorigin href="./assets/Output-DUep6sC9.css">
    <link rel="stylesheet" crossorigin href="./assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin href="./assets/index-CJU5NUvF.css">
  <marimo-wasm hidden=""></marimo-wasm>
    <script>
        if (window.location.protocol === 'file:') {
            alert('Warning: This file must be served by an HTTP server to function correctly.');
        }
    </script>
    
    <style>
        #save-button {
            display: none !important;
        }
        #filename-input {
            display: none !important;
        }
    </style>
    <marimo-code hidden="">import%20marimo%0A%0A__generated_with%20%3D%20%220.18.4%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20from%20mpl_toolkits.mplot3d%20import%20Axes3D%0A%20%20%20%20from%20pathlib%20import%20Path%0A%20%20%20%20from%20ipywidgets%20import%20interact%2C%20IntSlider%2C%20FloatSlider%2C%20Dropdown%0A%0A%20%20%20%20%23%20Get%20the%20directory%20where%20images%20are%20stored%0A%20%20%20%20IMAGE_DIR%20%3D%20Path(__file__).parent%20%2F%20%22lecture02_03_images%22%0A%20%20%20%20return%20IMAGE_DIR%2C%20mo%2C%20np%2C%20plt%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Introduction%20to%20Crystals%0A%20%20%20%20**ECE350%20Lectures%202-3**%0A%0A%20%20%20%20**January%207-9%2C%202026**%0A%0A%20%20%20%20**References%3A**%0A%20%20%20%20-%20Pierret%2C%20*Advanced%20Semiconductor%20Fundamentals*%2C%20Ch.1%0A%20%20%20%20-%20Hu%2C%20Ch.1%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%201.%20Motivation%0A%0A%20%20%20%20Electronic%20devices%20are%20made%20in%20materials%20classified%20as%20**semiconductors**.%20Many%20semiconductors%20are%20**crystals**.%20The%20crystal%20structure%20and%20orientation%20of%20a%20device%20with%20respect%20to%20the%20crystal%20have%20a%20significant%20impact%20on%20performance.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(IMAGE_DIR%2C%20mo)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%202.%20Semiconductors%0A%20%20%20%20The%20variable%20resistivity%20of%20semiconductors%20are%20used%20to%20create%20functional%20devices.%0A%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%7C%20Material%20Type%20%7C%20Resistivity%20%7C%0A%20%20%20%20%7C%3A------------------%3A%7C%3A--------------%3A%7C%0A%20%20%20%20%7C%20**Insulators**%20%7C%20%CF%81%20%3E%2010%E2%81%B8%20%CE%A9%C2%B7cm%20%7C%0A%20%20%20%20%7C%20**Conductors**%20%7C%20%CF%81%20%3C%2010%E2%81%BB%C2%B3%20%CE%A9%C2%B7cm%20%7C%0A%20%20%20%20%7C%20**Semiconductors**%20%7C%20**controllable**%20%3Cbr%3E%20(e.g.%2C%20by%20doping%2C%20temperature%2C%20light)%20%7C%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.image(src%3DIMAGE_DIR%20%2F%20%22resistivity_chart.jpg%22%2C%20width%3D%2270%25%22)%0A%20%20%20%20%20%20%20%20%5D%2C%20justify%3D%22start%22%2C%20align%3D%22center%22%2C%20gap%3D2)%0A%20%20%20%20%5D%2C%20align%3D%22start%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%203.%20What%20is%20a%20Crystal%3F%0A%0A%20%20%20%20-%20A%20**crystal**%20is%20an%20infinite%20periodic%20arrangement%20of%20atoms%20or%20group%20of%20atoms%20in%20space%0A%20%20%20%20-%20A%20crystal%20has%20**discrete%20translational%20invariance**%0A%20%20%20%20-%20Many%20important%20electronic%20materials%20(including%20silicon)%20are%20crystalline%0A%20%20%20%20-%20Material%20properties%20depend%20on%20crystal%20structure%20and%20vary%20with%20the%20direction%20and%20plane%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(IMAGE_DIR%2C%20mo)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%7C%20Type%20%7C%20Description%20%7C%20Example%20%7C%20Applications%20%7C%0A%20%20%20%20%7C%3A----%3A%7C%3A-----------%3A%7C%3A-------%3A%7C%3A------------%3A%7C%0A%20%20%20%20%7C%20**Crystalline**%20%7C%20Periodic%20crystal%20structure%20%7C%20Single-crystal%20Si%20%7C%20Most%20semiconductor%20devices%20%7C%0A%20%20%20%20%7C%20**Polycrystalline**%20%7C%20Crystal%20domains%2C%20short-range%20order%20%7C%20Poly-Si%20%7C%20Transistor%20gates%2C%20resistors%20%7C%0A%20%20%20%20%7C%20**Amorphous**%20%7C%20No%20crystal%20structure%20%7C%20a-Si%20%7C%20Low-cost%20solar%20cells%20%7C%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22**Crystalline**%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.image(src%3Dstr(IMAGE_DIR%20%2F%20%22crystalline-Si.jpg%22)%2C%20width%3D200)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%20align%3D%22center%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22**Polycrystalline**%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.image(src%3Dstr(IMAGE_DIR%20%2F%20%22poly-Si.jpg%22)%2C%20width%3D200)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%20align%3D%22center%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22**Amorphous**%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.image(src%3Dstr(IMAGE_DIR%20%2F%20%22a-Si.jpg%22)%2C%20width%3D200)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%20align%3D%22center%22)%2C%0A%20%20%20%20%20%20%20%20%5D%2C%20justify%3D%22space-around%22)%2C%0A%20%20%20%20%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%204.%20Crystal%20Definitions%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%7C%20Term%20%7C%20Definition%20%7C%0A%20%20%20%20%7C%3A------%3A%7C%3A------------%3A%7C%0A%20%20%20%20%7C%20**Lattice**%20%7C%20A%20set%20of%20points%20in%20space%20%3Cbr%3E%20%24%5Cvec%7BR%7D%20%3D%20u_1%20%5Cvec%7Ba%7D_1%20%2B%20u_2%20%5Cvec%7Ba%7D_2%20%2B%20u_3%20%5Cvec%7Ba%7D_3%24%2C%20%3Cbr%3E%20where%20%24%5C%7Bu_i%5C%7D%24%20are%20integers%2C%20%24%5C%7B%5Cvec%7Ba%7D_i%5C%7D%24%20are%20vectors%20%7C%0A%20%20%20%20%7C%20**Basis**%20%7C%20The%20group%20of%20atoms%20at%20each%20lattice%20point%20%3Cbr%3E%20%24%5Cvec%7Bb%7D_j%20%3D%20v_%7Bj%2C1%7D%20%5Cvec%7Ba%7D_1%20%2B%20v_%7Bj%2C2%7D%20%5Cvec%7Ba%7D_2%20%2B%20v_%7Bj%2C3%7D%20%5Cvec%7Ba%7D_3%24%2C%20%3Cbr%3Ewhere%20%24%5C%7B%5Cvec%7Bb%7D_j%5C%7D%24%20is%20the%20position%20of%20each%20atom%20in%20the%20group%2C%20%3Cbr%3E%24v_%7Bj%2Ci%7D%24%20is%20a%20real%20number%7C%0A%20%20%20%20%7C%20**Unit%20cell**%20%7C%20The%20volume%2Farea%20that%20is%20repeated%20to%20fill%20up%20all%20space%20%7C%0A%20%20%20%20%7C%20**Primitive%20cell**%20%7C%20The%20smallest%20unit%20cell%2C%20defined%20by%20%22primitive%20lattice%20vectors%22%20%7C%0A%20%20%20%20%7C%20**Lattice%20constant**%20%7C%20The%20periodicity%20of%20the%20lattice%20%7C%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%24%24%5Cboxed%7B%5Ctextbf%7BLattice%7D%20%2B%20%5Ctextbf%7BBasis%7D%20%20%3D%20%5Ctextbf%7BCrystal%20Structure%7D%7D%24%24%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20%5D%2C%20align%3D%22center%22)%2C%0A%20%20%20%20%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(IMAGE_DIR%2C%20mo)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22**2D%20Square%20Lattice**%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.image(src%3DIMAGE_DIR%20%2F%20%22lattice_2Dsquare.jpg%22%2C%20width%3D%22100%25%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%20align%3D%22start%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22**1-Atom%20Basis**%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.image(src%3DIMAGE_DIR%20%2F%20%22basis_1atom.jpg%22%2C%20width%3D%22100%25%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%20align%3D%22start%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22**2-Atom%20Basis**%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.image(src%3DIMAGE_DIR%20%2F%20%22basis_2atom.jpg%22%2C%20width%3D%22100%25%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%20align%3D%22start%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22**Unit%20Cell**%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.image(src%3DIMAGE_DIR%20%2F%20%22unitcell.jpg%22%2C%20width%3D%22100%25%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%20align%3D%22start%22)%2C%0A%20%20%20%20%20%20%20%20%5D%2C%20align%3D%22start%22%2C%20widths%3D%22equal%22%2C%20justify%3D%22space-between%22)%2C%0A%0A%20%20%20%20%20%20%20%20mo.md(%22**3D%20Primitive%20Vectors**%22)%2C%0A%20%20%20%20%20%20%20%20mo.image(src%3DIMAGE_DIR%20%2F%20%22bcc_primitive_vectors.jpg%22%2C%20width%3D300)%0A%20%20%20%20%5D%2C%20align%3D%22start%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%204.1%20Crystal%20Structure%20Key%20Features%0A%0A%20%20%20%201.%20There%20is%20only%20**one%20lattice%20point%20per%20primitive%20cell**%20but%20lattice%20points%20and%20edges%20are%20shared%20among%20adjacent%20cells%0A%20%20%20%202.%20The%20primitive%20basis%20is%20the%20minimal%20set%20of%20atoms%20needed%20to%20generate%20the%20full%20crystal%0A%20%20%20%203.%20The%20primitive%20unit%20cell%20is%20not%20unique!%0A%20%20%20%204.%20The%20**number%20of%20atoms**%20in%20a%20primitive%20cell%20is%20the%20same%0A%0A%20%20%20%20%23%23%23%204.2%20Wigner-Seitz%20Method%20(to%20choose%20a%20primitive%20cell)%0A%0A%20%20%20%201.%20Draw%20lines%20to%20connect%20a%20given%20lattice%20point%20to%20all%20nearby%20lattice%20points%0A%20%20%20%202.%20At%20the%20midpoint%20and%20normal%20to%20the%20lines%2C%20draw%20new%20lines%20(2D)%20or%20planes%20(3D)%0A%20%20%20%203.%20The%20smallest%20enclosed%20area%2Fvolume%20is%20the%20Wigner-Seitz%20cell%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%23mo.vstack(%5B%0A%20%20%20%20%23%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20%23%23%23%204.3%20Example%3A%20Graphene%20(2D%20Lattice)%0A%20%20%20%20%23-%20Lattice%20constant%3A%20**a%20%3D%20246%20pm**%0A%20%20%20%20%23-%20Basis%3A%202%20carbon%20atoms%20per%20unit%20cell%0A%20%20%20%20%23-%20Structure%3A%20Honeycomb%20lattice%20(hexagonal)%0A%0A%20%20%20%20%23**Questions%3A**%0A%20%20%20%20%231.%20Identify%20the%20lattice%20points%0A%20%20%20%20%231.%20What%20is%20the%20basis%3F%0A%20%20%20%20%231.%20Find%20a%20primitive%20cell%0A%20%20%20%20%231.%20Find%20primitive%20vectors%0A%0A%20%20%20%20%23%22%22%22)%2C%0A%20%20%20%20%23%20%20%20%20mo.image(src%3DIMAGE_DIR%20%2F%20%22graphene_3d.jpg%22%2C%20width%3D300)%0A%20%20%20%20%23%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%23%20mo.md(r%22%22%22%0A%20%20%20%20%23%20*Graphene%20lattice%20showing%3A*%0A%20%20%20%20%23%20-%20**Red%20dots**%3A%20Lattice%20points%0A%20%20%20%20%23%20-%20**Blue%20circles**%3A%20Atoms%0A%20%20%20%20%23%20-%20**Green%20circle**%3A%20Primitive%20cell%20(Wigner-Seitz)%0A%20%20%20%20%23%20-%20**Green%20arrows**%3A%20Primitive%20lattice%20vectors%20(%24%5Cvec%7Ba%7D_1%24%2C%20%24%5Cvec%7Ba%7D_2%24)%20at%2060%C2%B0%20and%20120%C2%B0%20angles%0A%20%20%20%20%23%20-%20**Black%20oval**%3A%20Primitive%20basis%20(2%20atoms)%0A%20%20%20%20%23%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%23%20Graphene%20annotated%20with%20primitive%20cell%2C%20lattice%20points%2C%20etc.%0A%20%20%20%20%23mo.image(src%3DIMAGE_DIR%20%2F%20%22graphene_annotated.png%22%2C%20width%3D800)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%205.%203D%20Crystal%20Lattices%0A%0A%20%20%20%20There%20are%20**14%20Bravais%20lattices**.%20Some%20common%20ones%3A%0A%0A%20%20%20%20%23%23%23%205.1%20Simple%20Cubic%20(SC)%0A%20%20%20%20-%20Atoms%20at%20corners%20of%20cube%0A%20%20%20%20-%201%20atom%20per%20cubic%20unit%20cell%0A%0A%20%20%20%20%23%23%23%205.2%20Body-Centered%20Cubic%20(BCC)%0A%20%20%20%20-%20Atoms%20at%20corners%20%2B%201%20atom%20at%20center%0A%20%20%20%20-%202%20atoms%20per%20cubic%20unit%20cell%0A%0A%20%20%20%20%23%23%23%205.3%20Face-Centered%20Cubic%20(FCC)%0A%20%20%20%20-%20Atoms%20at%20corners%20%2B%20atoms%20at%20face%20centers%0A%20%20%20%20-%204%20atoms%20per%20cubic%20unit%20cell%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np)%3A%0A%20%20%20%20%23%203D%20visualization%20of%20cubic%20lattices%20using%20plotly%20for%20interactivity%0A%20%20%20%20import%20plotly.graph_objects%20as%20go%0A%20%20%20%20from%20plotly.subplots%20import%20make_subplots%0A%0A%20%20%20%20%23%20Create%20subplots%0A%20%20%20%20_fig3d%20%3D%20make_subplots(%0A%20%20%20%20%20%20%20%20rows%3D1%2C%20cols%3D3%2C%0A%20%20%20%20%20%20%20%20specs%3D%5B%5B%7B'type'%3A%20'scatter3d'%7D%2C%20%7B'type'%3A%20'scatter3d'%7D%2C%20%7B'type'%3A%20'scatter3d'%7D%5D%5D%2C%0A%20%20%20%20%20%20%20%20subplot_titles%3D('Simple%20Cubic%20(SC)'%2C%20'Body-Centered%20Cubic%20(BCC)'%2C%20'Face-Centered%20Cubic%20(FCC)')%2C%0A%20%20%20%20%20%20%20%20horizontal_spacing%3D0.05%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Corner%20atoms%20for%20all%20structures%0A%20%20%20%20_corners%20%3D%20np.array(%5B%5B0%2C0%2C0%5D%2C%20%5B1%2C0%2C0%5D%2C%20%5B0%2C1%2C0%5D%2C%20%5B0%2C0%2C1%5D%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B1%2C1%2C0%5D%2C%20%5B1%2C0%2C1%5D%2C%20%5B0%2C1%2C1%5D%2C%20%5B1%2C1%2C1%5D%5D)%0A%0A%20%20%20%20%23%20Cube%20edges%0A%20%20%20%20_edges%20%3D%20%5B%0A%20%20%20%20%20%20%20%20(%5B0%2C1%5D%2C%20%5B0%2C0%5D%2C%20%5B0%2C0%5D)%2C%20(%5B0%2C0%5D%2C%20%5B0%2C1%5D%2C%20%5B0%2C0%5D)%2C%20(%5B0%2C0%5D%2C%20%5B0%2C0%5D%2C%20%5B0%2C1%5D)%2C%0A%20%20%20%20%20%20%20%20(%5B1%2C1%5D%2C%20%5B0%2C1%5D%2C%20%5B0%2C0%5D)%2C%20(%5B1%2C1%5D%2C%20%5B0%2C0%5D%2C%20%5B0%2C1%5D)%2C%20(%5B0%2C1%5D%2C%20%5B1%2C1%5D%2C%20%5B0%2C0%5D)%2C%0A%20%20%20%20%20%20%20%20(%5B0%2C0%5D%2C%20%5B1%2C1%5D%2C%20%5B0%2C1%5D)%2C%20(%5B0%2C1%5D%2C%20%5B0%2C0%5D%2C%20%5B1%2C1%5D)%2C%20(%5B0%2C0%5D%2C%20%5B0%2C1%5D%2C%20%5B1%2C1%5D)%2C%0A%20%20%20%20%20%20%20%20(%5B1%2C1%5D%2C%20%5B1%2C1%5D%2C%20%5B0%2C1%5D)%2C%20(%5B1%2C1%5D%2C%20%5B0%2C1%5D%2C%20%5B1%2C1%5D)%2C%20(%5B0%2C1%5D%2C%20%5B1%2C1%5D%2C%20%5B1%2C1%5D)%0A%20%20%20%20%5D%0A%0A%20%20%20%20%23%20Arrow%20colors%0A%20%20%20%20_arrow_colors%20%3D%20%5B'red'%2C%20'green'%2C%20'orange'%5D%0A%0A%20%20%20%20%23%20Function%20to%20add%20arrow%20(line%20%2B%20cone)%20for%20primitive%20vectors%0A%20%20%20%20def%20_add_arrow(fig%2C%20start%2C%20end%2C%20color%2C%20name%2C%20row%2C%20col)%3A%0A%20%20%20%20%20%20%20%20%23%20Add%20line%20for%20the%20arrow%20shaft%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5Bstart%5B0%5D%2C%20end%5B0%5D%5D%2C%20y%3D%5Bstart%5B1%5D%2C%20end%5B1%5D%5D%2C%20z%3D%5Bstart%5B2%5D%2C%20end%5B2%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%20line%3Ddict(color%3Dcolor%2C%20width%3D6)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3Dname%2C%20showlegend%3DFalse%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20row%3Drow%2C%20col%3Dcol%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%23%20Add%20cone%20for%20the%20arrow%20head%0A%20%20%20%20%20%20%20%20direction%20%3D%20np.array(end)%20-%20np.array(start)%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Cone(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5Bend%5B0%5D%5D%2C%20y%3D%5Bend%5B1%5D%5D%2C%20z%3D%5Bend%5B2%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20u%3D%5Bdirection%5B0%5D*0.3%5D%2C%20v%3D%5Bdirection%5B1%5D*0.3%5D%2C%20w%3D%5Bdirection%5B2%5D*0.3%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorscale%3D%5B%5B0%2C%20color%5D%2C%20%5B1%2C%20color%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showscale%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sizemode%3D'absolute'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sizeref%3D0.15%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3Dname%2C%20showlegend%3DFalse%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20row%3Drow%2C%20col%3Dcol%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%23%20Simple%20Cubic%20-%20primitive%20vectors%20are%20the%20conventional%20unit%20cell%20vectors%0A%20%20%20%20_sc_vectors%20%3D%20%5B%0A%20%20%20%20%20%20%20%20(%5B0%2C0%2C0%5D%2C%20%5B1%2C0%2C0%5D%2C%20'a%E2%82%81')%2C%0A%20%20%20%20%20%20%20%20(%5B0%2C0%2C0%5D%2C%20%5B0%2C1%2C0%5D%2C%20'a%E2%82%82')%2C%0A%20%20%20%20%20%20%20%20(%5B0%2C0%2C0%5D%2C%20%5B0%2C0%2C1%5D%2C%20'a%E2%82%83')%0A%20%20%20%20%5D%0A%0A%20%20%20%20_fig3d.add_trace(%0A%20%20%20%20%20%20%20%20go.Scatter3d(x%3D_corners%5B%3A%2C0%5D%2C%20y%3D_corners%5B%3A%2C1%5D%2C%20z%3D_corners%5B%3A%2C2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'markers'%2C%20marker%3Ddict(size%3D10%2C%20color%3D'blue')%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3D'Corner%20atoms'%2C%20showlegend%3DFalse)%2C%0A%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D1%0A%20%20%20%20)%0A%20%20%20%20for%20_edge%20in%20_edges%3A%0A%20%20%20%20%20%20%20%20_fig3d.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter3d(x%3D_edge%5B0%5D%2C%20y%3D_edge%5B1%5D%2C%20z%3D_edge%5B2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%20line%3Ddict(color%3D'gray'%2C%20width%3D2)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D1%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%23%20Add%20SC%20primitive%20vectors%0A%20%20%20%20for%20_i%2C%20(_start%2C%20_end%2C%20_label)%20in%20enumerate(_sc_vectors)%3A%0A%20%20%20%20%20%20%20%20_add_arrow(_fig3d%2C%20_start%2C%20_end%2C%20_arrow_colors%5B_i%5D%2C%20_label%2C%201%2C%201)%0A%0A%20%20%20%20%23%20BCC%20-%20primitive%20vectors%20from%20origin%0A%20%20%20%20%23%20a1%20%3D%20(1%2F2)(a%2C%20a%2C%20-a)%20-%3E%20to%20corner%20via%20center%2C%20but%20commonly%20shown%20as%3A%0A%20%20%20%20%23%20a1%20%3D%20(1%2C%200%2C%200)%2C%20a2%20%3D%20(0%2C%201%2C%200)%2C%20a3%20%3D%20(1%2F2%2C%201%2F2%2C%201%2F2)%20for%20conventional%0A%20%20%20%20%23%20Or%20true%20primitive%3A%20a1%20%3D%20(-0.5%2C%200.5%2C%200.5)%2C%20a2%20%3D%20(0.5%2C%20-0.5%2C%200.5)%2C%20a3%20%3D%20(0.5%2C%200.5%2C%20-0.5)%0A%20%20%20%20_bcc_vectors%20%3D%20%5B%0A%20%20%20%20%20%20%20%20(%5B0%2C0%2C0%5D%2C%20%5B0.5%2C%200.5%2C%200.5%5D%2C%20'a%E2%82%81')%2C%20%20%20%23%20to%20body%20center%0A%20%20%20%20%20%20%20%20(%5B0%2C0%2C0%5D%2C%20%5B1%2C%200%2C%200%5D%2C%20'a%E2%82%82')%2C%0A%20%20%20%20%20%20%20%20(%5B0%2C0%2C0%5D%2C%20%5B0%2C%201%2C%200%5D%2C%20'a%E2%82%83')%0A%20%20%20%20%5D%0A%20%20%20%20%23%20True%20primitive%20vectors%20for%20BCC%20(from%20origin)%0A%20%20%20%20_bcc_primitive%20%3D%20%5B%0A%20%20%20%20%20%20%20%20(%5B0%2C0%2C0%5D%2C%20%5B-0.5%2C%200.5%2C%200.5%5D%2C%20'a%E2%82%81')%2C%0A%20%20%20%20%20%20%20%20(%5B0%2C0%2C0%5D%2C%20%5B0.5%2C%20-0.5%2C%200.5%5D%2C%20'a%E2%82%82')%2C%0A%20%20%20%20%20%20%20%20(%5B0%2C0%2C0%5D%2C%20%5B0.5%2C%200.5%2C%20-0.5%5D%2C%20'a%E2%82%83')%0A%20%20%20%20%5D%0A%0A%20%20%20%20_fig3d.add_trace(%0A%20%20%20%20%20%20%20%20go.Scatter3d(x%3D_corners%5B%3A%2C0%5D%2C%20y%3D_corners%5B%3A%2C1%5D%2C%20z%3D_corners%5B%3A%2C2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'markers'%2C%20marker%3Ddict(size%3D10%2C%20color%3D'blue')%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3D'Corner%20atoms'%2C%20showlegend%3DFalse)%2C%0A%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D2%0A%20%20%20%20)%0A%20%20%20%20_fig3d.add_trace(%0A%20%20%20%20%20%20%20%20go.Scatter3d(x%3D%5B0.5%5D%2C%20y%3D%5B0.5%5D%2C%20z%3D%5B0.5%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'markers'%2C%20marker%3Ddict(size%3D12%2C%20color%3D'red')%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3D'Center%20atom'%2C%20showlegend%3DFalse)%2C%0A%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D2%0A%20%20%20%20)%0A%20%20%20%20for%20_edge%20in%20_edges%3A%0A%20%20%20%20%20%20%20%20_fig3d.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter3d(x%3D_edge%5B0%5D%2C%20y%3D_edge%5B1%5D%2C%20z%3D_edge%5B2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%20line%3Ddict(color%3D'gray'%2C%20width%3D2)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D2%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%23%20Add%20BCC%20primitive%20vectors%20(true%20primitive%20from%20center%20atom)%0A%20%20%20%20_bcc_true_primitive%20%3D%20%5B%0A%20%20%20%20%20%20%20%20(%5B0.5%2C%200.5%2C%200.5%5D%2C%20%5B1%2C%201%2C%200%5D%2C%20'a%E2%82%81')%2C%0A%20%20%20%20%20%20%20%20(%5B0.5%2C%200.5%2C%200.5%5D%2C%20%5B1%2C%200%2C%201%5D%2C%20'a%E2%82%82')%2C%0A%20%20%20%20%20%20%20%20(%5B0.5%2C%200.5%2C%200.5%5D%2C%20%5B0%2C%201%2C%201%5D%2C%20'a%E2%82%83')%0A%20%20%20%20%5D%0A%20%20%20%20for%20_i%2C%20(_start%2C%20_end%2C%20_label)%20in%20enumerate(_bcc_true_primitive)%3A%0A%20%20%20%20%20%20%20%20_add_arrow(_fig3d%2C%20_start%2C%20_end%2C%20_arrow_colors%5B_i%5D%2C%20_label%2C%201%2C%202)%0A%0A%20%20%20%20%23%20FCC%20-%20primitive%20vectors%0A%20%20%20%20%23%20a1%20%3D%20(0.5%2C%200.5%2C%200)%2C%20a2%20%3D%20(0.5%2C%200%2C%200.5)%2C%20a3%20%3D%20(0%2C%200.5%2C%200.5)%0A%20%20%20%20_fcc_vectors%20%3D%20%5B%0A%20%20%20%20%20%20%20%20(%5B0%2C0%2C0%5D%2C%20%5B0.5%2C%200.5%2C%200%5D%2C%20'a%E2%82%81')%2C%0A%20%20%20%20%20%20%20%20(%5B0%2C0%2C0%5D%2C%20%5B0.5%2C%200%2C%200.5%5D%2C%20'a%E2%82%82')%2C%0A%20%20%20%20%20%20%20%20(%5B0%2C0%2C0%5D%2C%20%5B0%2C%200.5%2C%200.5%5D%2C%20'a%E2%82%83')%0A%20%20%20%20%5D%0A%0A%20%20%20%20_face_centers%20%3D%20np.array(%5B%5B0.5%2C0.5%2C0%5D%2C%20%5B0.5%2C0%2C0.5%5D%2C%20%5B0%2C0.5%2C0.5%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B0.5%2C0.5%2C1%5D%2C%20%5B0.5%2C1%2C0.5%5D%2C%20%5B1%2C0.5%2C0.5%5D%5D)%0A%20%20%20%20_fig3d.add_trace(%0A%20%20%20%20%20%20%20%20go.Scatter3d(x%3D_corners%5B%3A%2C0%5D%2C%20y%3D_corners%5B%3A%2C1%5D%2C%20z%3D_corners%5B%3A%2C2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'markers'%2C%20marker%3Ddict(size%3D10%2C%20color%3D'blue')%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3D'Corner%20atoms'%2C%20showlegend%3DFalse)%2C%0A%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D3%0A%20%20%20%20)%0A%20%20%20%20_fig3d.add_trace(%0A%20%20%20%20%20%20%20%20go.Scatter3d(x%3D_face_centers%5B%3A%2C0%5D%2C%20y%3D_face_centers%5B%3A%2C1%5D%2C%20z%3D_face_centers%5B%3A%2C2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'markers'%2C%20marker%3Ddict(size%3D10%2C%20color%3D'green')%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3D'Face%20center%20atoms'%2C%20showlegend%3DFalse)%2C%0A%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D3%0A%20%20%20%20)%0A%20%20%20%20for%20_edge%20in%20_edges%3A%0A%20%20%20%20%20%20%20%20_fig3d.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter3d(x%3D_edge%5B0%5D%2C%20y%3D_edge%5B1%5D%2C%20z%3D_edge%5B2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%20line%3Ddict(color%3D'gray'%2C%20width%3D2)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D3%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%23%20Add%20FCC%20primitive%20vectors%0A%20%20%20%20for%20_i%2C%20(_start%2C%20_end%2C%20_label)%20in%20enumerate(_fcc_vectors)%3A%0A%20%20%20%20%20%20%20%20_add_arrow(_fig3d%2C%20_start%2C%20_end%2C%20_arrow_colors%5B_i%5D%2C%20_label%2C%201%2C%203)%0A%0A%20%20%20%20%23%20Add%20legend%20for%20primitive%20vectors%20using%20lines%20(arrows)%20instead%20of%20markers%0A%20%20%20%20_fig3d.add_trace(%0A%20%20%20%20%20%20%20%20go.Scatter3d(x%3D%5BNone%2C%20None%5D%2C%20y%3D%5BNone%2C%20None%5D%2C%20z%3D%5BNone%2C%20None%5D%2C%20mode%3D'lines'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(width%3D3%2C%20color%3D'red')%2C%20name%3Dr'%24%5Cvec%7Ba%7D_1%24'%2C%20showlegend%3DTrue)%2C%0A%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D1%0A%20%20%20%20)%0A%20%20%20%20_fig3d.add_trace(%0A%20%20%20%20%20%20%20%20go.Scatter3d(x%3D%5BNone%2C%20None%5D%2C%20y%3D%5BNone%2C%20None%5D%2C%20z%3D%5BNone%2C%20None%5D%2C%20mode%3D'lines'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(width%3D3%2C%20color%3D'green')%2C%20name%3Dr'%24%5Cvec%7Ba%7D_2%24'%2C%20showlegend%3DTrue)%2C%0A%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D1%0A%20%20%20%20)%0A%20%20%20%20_fig3d.add_trace(%0A%20%20%20%20%20%20%20%20go.Scatter3d(x%3D%5BNone%2C%20None%5D%2C%20y%3D%5BNone%2C%20None%5D%2C%20z%3D%5BNone%2C%20None%5D%2C%20mode%3D'lines'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(width%3D3%2C%20color%3D'orange')%2C%20name%3Dr'%24%5Cvec%7Ba%7D_3%24'%2C%20showlegend%3DTrue)%2C%0A%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D1%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Update%20layout%0A%20%20%20%20_fig3d.update_layout(%0A%20%20%20%20%20%20%20%20height%3D500%2C%0A%20%20%20%20%20%20%20%20width%3D1200%2C%0A%20%20%20%20%20%20%20%20title_text%3D%22Interactive%203D%20Cubic%20Lattices%20with%20Primitive%20Vectors%20(click%20and%20drag%20to%20rotate)%22%2C%0A%20%20%20%20%20%20%20%20legend%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20yanchor%3D%22top%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3D%20-0.2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20xanchor%3D%22left%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3D0.0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20orientation%3D%22h%22%2C%0A%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20margin%3Ddict(b%3D80)%2C%0A%20%20%20%20%20%20%20%20scene%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20xaxis_title%3D'x'%2C%20yaxis_title%3D'y'%2C%20zaxis_title%3D'z'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20aspectmode%3D'cube'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20camera%3Ddict(eye%3Ddict(x%3D1.5%2C%20y%3D1.5%2C%20z%3D1.5))%0A%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20scene2%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20xaxis_title%3D'x'%2C%20yaxis_title%3D'y'%2C%20zaxis_title%3D'z'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20aspectmode%3D'cube'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20camera%3Ddict(eye%3Ddict(x%3D1.5%2C%20y%3D1.5%2C%20z%3D1.5))%0A%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20scene3%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20xaxis_title%3D'x'%2C%20yaxis_title%3D'y'%2C%20zaxis_title%3D'z'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20aspectmode%3D'cube'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20camera%3Ddict(eye%3Ddict(x%3D1.5%2C%20y%3D1.5%2C%20z%3D1.5))%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%0A%20%20%20%20_fig3d%0A%20%20%20%20return%20(go%2C)%0A%0A%0A%40app.cell%0Adef%20_(IMAGE_DIR%2C%20mo)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%205.4%20Diamond%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20-%20Diamond%20lattice%20is%3A%0A%20%20%20%20%20%20-%20FCC%20with%20a%20**2-atom%20basis**%20at%20positions%3A%0A%20%20%20%20%20%20%20%20-%20%24%5Cvec%7Bb%7D_1%20%3D%20(0%2C%200%2C%200)%24%0A%20%20%20%20%20%20%20%20-%20%24%5Cvec%7Bb%7D_2%20%3D%20(%5Cfrac%7B1%7D%7B4%7D%2C%20%5Cfrac%7B1%7D%7B4%7D%2C%20%5Cfrac%7B1%7D%7B4%7D)%24%0A%0A%20%20%20%20-%20Diamond%20is%20**two%20interlaced%20FCC%20lattices**!%0A%20%20%20%20-%20**Silicon%20and%20Germanium**%20(Group%20IV)%20have%20a%20diamond%20crystal%20structure.%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.image(src%3DIMAGE_DIR%20%2F%20%22diamond_structure.jpg%22%2C%20width%3D%2250%25%22)%0A%20%20%20%20%20%20%20%20%5D%2C%20justify%3D%22start%22%2C%20%20gap%3D2)%0A%20%20%20%20%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np)%3A%0A%20%20%20%20def%20_()%3A%0A%20%20%20%20%20%20%20%20%23%20Interactive%20Diamond%20Lattice%20Visualization%20-%208%20Unit%20Cells%20(2x2x2)%0A%20%20%20%20%20%20%20%20import%20plotly.graph_objects%20as%20go%0A%0A%20%20%20%20%20%20%20%20%23%20First%20FCC%20lattice%20(blue)%20-%20corners%20and%20face%20centers%20for%20one%20unit%20cell%0A%20%20%20%20%20%20%20%20_fcc1_corners_base%20%3D%20np.array(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B0%2C0%2C0%5D%2C%20%5B1%2C0%2C0%5D%2C%20%5B0%2C1%2C0%5D%2C%20%5B0%2C0%2C1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B1%2C1%2C0%5D%2C%20%5B1%2C0%2C1%5D%2C%20%5B0%2C1%2C1%5D%2C%20%5B1%2C1%2C1%5D%0A%20%20%20%20%20%20%20%20%5D)%0A%0A%20%20%20%20%20%20%20%20_fcc1_faces_base%20%3D%20np.array(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B0.5%2C%200.5%2C%200%5D%2C%20%5B0.5%2C%200%2C%200.5%5D%2C%20%5B0%2C%200.5%2C%200.5%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B0.5%2C%200.5%2C%201%5D%2C%20%5B0.5%2C%201%2C%200.5%5D%2C%20%5B1%2C%200.5%2C%200.5%5D%0A%20%20%20%20%20%20%20%20%5D)%0A%0A%20%20%20%20%20%20%20%20%23%20Second%20FCC%20lattice%20offset%0A%20%20%20%20%20%20%20%20_offset%20%3D%20np.array(%5B0.25%2C%200.25%2C%200.25%5D)%0A%0A%20%20%20%20%20%20%20%20%23%20Generate%208%20unit%20cells%20(2x2x2%20arrangement)%0A%20%20%20%20%20%20%20%20_fcc1_all_list%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20_fcc2_all_list%20%3D%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20for%20_ix%20in%20range(2)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20_iy%20in%20range(2)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20_iz%20in%20range(2)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_shift%20%3D%20np.array(%5B_ix%2C%20_iy%2C%20_iz%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_fcc1_all_list.append(_fcc1_corners_base%20%2B%20_shift)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_fcc1_all_list.append(_fcc1_faces_base%20%2B%20_shift)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_fcc2_all_list.append(_fcc1_corners_base%20%2B%20_offset%20%2B%20_shift)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_fcc2_all_list.append(_fcc1_faces_base%20%2B%20_offset%20%2B%20_shift)%0A%0A%20%20%20%20%20%20%20%20_fcc1_all%20%3D%20np.vstack(_fcc1_all_list)%0A%20%20%20%20%20%20%20%20_fcc2_all%20%3D%20np.vstack(_fcc2_all_list)%0A%0A%20%20%20%20%20%20%20%20%23%20Remove%20duplicate%20atoms%20(atoms%20at%20shared%20boundaries)%0A%20%20%20%20%20%20%20%20def%20_unique_atoms(atoms%2C%20tol%3D0.01)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20unique%20%3D%20%5Batoms%5B0%5D%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20atom%20in%20atoms%5B1%3A%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20is_duplicate%20%3D%20False%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20u%20in%20unique%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20np.linalg.norm(atom%20-%20u)%20%3C%20tol%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20is_duplicate%20%3D%20True%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20is_duplicate%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20unique.append(atom)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20np.array(unique)%0A%0A%20%20%20%20%20%20%20%20_fcc1_unique%20%3D%20_unique_atoms(_fcc1_all)%0A%0A%20%20%20%20%20%20%20%20%23%20Filter%20atoms%20that%20are%20within%20or%20close%20to%20the%202x2x2%20unit%20cell%20region%0A%20%20%20%20%20%20%20%20def%20_filter_atoms(atoms%2C%20margin%3D0.01%2C%20x_max%3D2%2C%20y_max%3D2%2C%20z_max%3D2)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mask%20%3D%20np.all((atoms%20%3E%3D%20-margin)%20%26%20(atoms%20%3C%3D%20np.array(%5Bx_max%2C%20y_max%2C%20z_max%5D)%20%2B%20margin)%2C%20axis%3D1)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20atoms%5Bmask%5D%0A%0A%20%20%20%20%20%20%20%20_fcc2_filtered%20%3D%20_filter_atoms(_fcc2_all)%0A%20%20%20%20%20%20%20%20_fcc2_unique%20%3D%20_unique_atoms(_fcc2_filtered)%0A%0A%20%20%20%20%20%20%20%20%23%20Create%20the%20figure%0A%20%20%20%20%20%20%20%20_fig_diamond%20%3D%20go.Figure()%0A%0A%20%20%20%20%20%20%20%20%23%20Add%20first%20FCC%20lattice%20(blue)%20-%20trace%20index%200%0A%20%20%20%20%20%20%20%20_fig_diamond.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3D_fcc1_unique%5B%3A%2C%200%5D%2C%20y%3D_fcc1_unique%5B%3A%2C%201%5D%2C%20z%3D_fcc1_unique%5B%3A%2C%202%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'markers'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20marker%3Ddict(size%3D10%2C%20color%3D'blue'%2C%20opacity%3D0.9)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20name%3D'FCC%20Lattice%201%20(blue)'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20visible%3DTrue%0A%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20%23%20Add%20second%20FCC%20lattice%20(red)%20-%20trace%20index%201%0A%20%20%20%20%20%20%20%20_fig_diamond.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3D_fcc2_unique%5B%3A%2C%200%5D%2C%20y%3D_fcc2_unique%5B%3A%2C%201%5D%2C%20z%3D_fcc2_unique%5B%3A%2C%202%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'markers'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20marker%3Ddict(size%3D10%2C%20color%3D'red'%2C%20opacity%3D0.9)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20name%3D'FCC%20Lattice%202%20(red%2C%20offset%20by%20a%2F4)'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20visible%3DTrue%0A%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20%23%20Add%20tetrahedral%20bonds%20between%20nearest%20neighbors%0A%20%20%20%20%20%20%20%20%23%20Bond%20length%20in%20diamond%20is%20sqrt(3)%2F4%20*%20a%20%E2%89%88%200.433a%0A%20%20%20%20%20%20%20%20_bond_length%20%3D%20np.sqrt(3)%20%2F%204%20%2B%200.01%20%20%23%20with%20small%20tolerance%0A%0A%20%20%20%20%20%20%20%20%23%20Store%20bond%20trace%20indices%20for%20toggling%0A%20%20%20%20%20%20%20%20_bond_trace_start%20%3D%202%20%20%23%20Bonds%20start%20after%20the%20two%20atom%20traces%0A%0A%20%20%20%20%20%20%20%20%23%20Find%20all%20bonds%20between%20FCC1%20and%20FCC2%20atoms%0A%20%20%20%20%20%20%20%20for%20_p1%20in%20_fcc2_unique%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20_p2%20in%20_fcc1_unique%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_dist%20%3D%20np.linalg.norm(_p1%20-%20_p2)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20_dist%20%3C%20_bond_length%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_fig_diamond.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5B_p1%5B0%5D%2C%20_p2%5B0%5D%5D%2C%20y%3D%5B_p1%5B1%5D%2C%20_p2%5B1%5D%5D%2C%20z%3D%5B_p1%5B2%5D%2C%20_p2%5B2%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(color%3D'gray'%2C%20width%3D3)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20hoverinfo%3D'skip'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20_bond_trace_end%20%3D%20len(_fig_diamond.data)%20%20%23%20Number%20of%20traces%20after%20adding%20bonds%0A%20%20%20%20%20%20%20%20_num_bond_traces%20%3D%20_bond_trace_end%20-%20_bond_trace_start%0A%0A%20%20%20%20%20%20%20%20%23%20Add%20cube%20edges%20for%20all%208%20unit%20cells%0A%20%20%20%20%20%20%20%20for%20_ix%20in%20range(2)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20_iy%20in%20range(2)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20_iz%20in%20range(2)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_cube_edges%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%5B0%2B_ix%2C%201%2B_ix%5D%2C%20%5B0%2B_iy%2C%200%2B_iy%5D%2C%20%5B0%2B_iz%2C%200%2B_iz%5D)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%5B0%2B_ix%2C%200%2B_ix%5D%2C%20%5B0%2B_iy%2C%201%2B_iy%5D%2C%20%5B0%2B_iz%2C%200%2B_iz%5D)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%5B0%2B_ix%2C%200%2B_ix%5D%2C%20%5B0%2B_iy%2C%200%2B_iy%5D%2C%20%5B0%2B_iz%2C%201%2B_iz%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%5B1%2B_ix%2C%201%2B_ix%5D%2C%20%5B0%2B_iy%2C%201%2B_iy%5D%2C%20%5B0%2B_iz%2C%200%2B_iz%5D)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%5B1%2B_ix%2C%201%2B_ix%5D%2C%20%5B0%2B_iy%2C%200%2B_iy%5D%2C%20%5B0%2B_iz%2C%201%2B_iz%5D)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%5B0%2B_ix%2C%201%2B_ix%5D%2C%20%5B1%2B_iy%2C%201%2B_iy%5D%2C%20%5B0%2B_iz%2C%200%2B_iz%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%5B0%2B_ix%2C%200%2B_ix%5D%2C%20%5B1%2B_iy%2C%201%2B_iy%5D%2C%20%5B0%2B_iz%2C%201%2B_iz%5D)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%5B0%2B_ix%2C%201%2B_ix%5D%2C%20%5B0%2B_iy%2C%200%2B_iy%5D%2C%20%5B1%2B_iz%2C%201%2B_iz%5D)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%5B0%2B_ix%2C%200%2B_ix%5D%2C%20%5B0%2B_iy%2C%201%2B_iy%5D%2C%20%5B1%2B_iz%2C%201%2B_iz%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%5B1%2B_ix%2C%201%2B_ix%5D%2C%20%5B1%2B_iy%2C%201%2B_iy%5D%2C%20%5B0%2B_iz%2C%201%2B_iz%5D)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%5B1%2B_ix%2C%201%2B_ix%5D%2C%20%5B0%2B_iy%2C%201%2B_iy%5D%2C%20%5B1%2B_iz%2C%201%2B_iz%5D)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%5B0%2B_ix%2C%201%2B_ix%5D%2C%20%5B1%2B_iy%2C%201%2B_iy%5D%2C%20%5B1%2B_iz%2C%201%2B_iz%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20_edge%20in%20_cube_edges%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_fig_diamond.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D_edge%5B0%5D%2C%20y%3D_edge%5B1%5D%2C%20z%3D_edge%5B2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(color%3D'black'%2C%20width%3D1.5%2C%20dash%3D'dash')%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20hoverinfo%3D'skip'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20_total_traces%20%3D%20len(_fig_diamond.data)%0A%20%20%20%20%20%20%20%20_num_edge_traces%20%3D%20_total_traces%20-%20_bond_trace_end%0A%0A%20%20%20%20%20%20%20%20%23%20Create%20visibility%20arrays%20for%20buttons%0A%20%20%20%20%20%20%20%20%23%20All%20visible%0A%20%20%20%20%20%20%20%20_vis_all%20%3D%20%5BTrue%5D%20*%20_total_traces%0A%0A%20%20%20%20%20%20%20%20%23%20Only%20FCC1%20(blue)%20-%20hide%20red%20atoms%20and%20bonds%0A%20%20%20%20%20%20%20%20_vis_fcc1_only%20%3D%20%5BTrue%5D%20%2B%20%5BFalse%5D%20%2B%20%5BFalse%5D%20*%20_num_bond_traces%20%2B%20%5BTrue%5D%20*%20_num_edge_traces%0A%0A%20%20%20%20%20%20%20%20%23%20Only%20FCC2%20(red)%20-%20hide%20blue%20atoms%20and%20bonds%0A%20%20%20%20%20%20%20%20_vis_fcc2_only%20%3D%20%5BFalse%5D%20%2B%20%5BTrue%5D%20%2B%20%5BFalse%5D%20*%20_num_bond_traces%20%2B%20%5BTrue%5D%20*%20_num_edge_traces%0A%0A%20%20%20%20%20%20%20%20%23%20Both%20lattices%2C%20no%20bonds%0A%20%20%20%20%20%20%20%20_vis_no_bonds%20%3D%20%5BTrue%2C%20True%5D%20%2B%20%5BFalse%5D%20*%20_num_bond_traces%20%2B%20%5BTrue%5D%20*%20_num_edge_traces%0A%0A%20%20%20%20%20%20%20%20%23%20Update%20layout%20with%20buttons%20below%20the%20visualization%0A%20%20%20%20%20%20%20%20_fig_diamond.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%3D'Diamond%20Lattice%3A%208%20Unit%20Cells%20(2%C3%972%C3%972)%3Cbr%3E%3Csub%3ETwo%20Interpenetrating%20FCC%20Lattices%20%7C%20Click%20and%20drag%20to%20rotate%20%7C%20Scroll%20to%20zoom%3C%2Fsub%3E'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D0.5%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scene%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xaxis_title%3D'x%20%5Ba%5D'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yaxis_title%3D'y%20%5Ba%5D'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zaxis_title%3D'z%20%5Ba%5D'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20aspectmode%3D'data'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20camera%3Ddict(eye%3Ddict(x%3D2.0%2C%20y%3D2.0%2C%20z%3D1.5))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xaxis%3Ddict(range%3D%5B-0.2%2C%202.3%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yaxis%3Ddict(range%3D%5B-0.2%2C%202.3%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zaxis%3Ddict(range%3D%5B-0.2%2C%202.3%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20legend%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yanchor%3D%22top%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D0.99%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xanchor%3D%22left%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D0.01%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20itemclick%3D%22toggle%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20itemdoubleclick%3D%22toggleothers%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20updatemenus%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20type%3D%22buttons%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20direction%3D%22right%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20active%3D0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D0.5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D-0.05%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xanchor%3D%22center%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yanchor%3D%22top%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20buttons%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Show%20Both%20Lattices%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20method%3D%22update%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args%3D%5B%7B%22visible%22%3A%20_vis_all%7D%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22FCC%201%20Only%20(Blue)%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20method%3D%22update%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args%3D%5B%7B%22visible%22%3A%20_vis_fcc1_only%7D%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22FCC%202%20Only%20(Red)%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20method%3D%22update%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args%3D%5B%7B%22visible%22%3A%20_vis_fcc2_only%7D%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Both%20(No%20Bonds)%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20method%3D%22update%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args%3D%5B%7B%22visible%22%3A%20_vis_no_bonds%7D%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20annotations%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%3D%22Toggle%20Lattices%3A%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D0.15%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D-0.05%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xref%3D%22paper%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yref%3D%22paper%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showarrow%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font%3Ddict(size%3D12)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D750%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D900%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3Ddict(l%3D0%2C%20r%3D0%2C%20t%3D80%2C%20b%3D80)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20return%20_fig_diamond%0A%0A%0A%20%20%20%20_()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(IMAGE_DIR%2C%20mo)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%205.5%20Zinc%20Blende%20%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20-%20Similar%20to%20diamond%0A%20%20%20%20-%20One%20atom%20of%20the%20basis%20is%20**Group%20III**%20(e.g.%2C%20Ga%2C%20In)%20and%20the%20other%20is%20**Group%20V**%20(e.g.%2C%20As%2C%20P)%0A%0A%20%20%20%20-%20**Examples%3A**%20GaAs%2C%20InP%0A%0A%20%20%20%20-%20III-V%20compounds%20are%20important%20for%20**optoelectronics**%20and%20**high-speed%20electronics**.%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.image(src%3DIMAGE_DIR%20%2F%20%22zinc_blende_structure.jpg%22%2C%20width%3D%2240%25%22)%0A%20%20%20%20%20%20%20%20%5D%2C%20justify%3D%22start%22%2C%20gap%3D2)%0A%20%20%20%20%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(IMAGE_DIR%2C%20mo)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(rf%22%22%22%0A%20%20%20%20%23%23%206.%20Elemental%20and%20Compound%20Semiconductors%0A%0A%20%20%20%20-%20Elemental%20semiconductors%20are%20made%20of%201%20element%0A%20%20%20%20%20%20%20%20-%20e.g.%2C%20Group%20IV%20(Si%2C%20Ge%2C%20C)%0A%20%20%20%20-%20Compound%20semiconductors%20are%20made%20of%20more%20than%201%20element%20%0A%20%20%20%20%20%20%20%20-%20e.g.%2C%20III-V%20(GaAs%2C%20InP%2C%20GaN%2C%20Al%24_x%24Ga%24_%7B%7B1-x%7D%7D%24As)%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20mo.image(src%3DIMAGE_DIR%20%2F%20%22periodictable.jpg%22%2C%20width%3D%2270%25%22)%0A%20%20%20%20%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(IMAGE_DIR%2C%20mo)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%206.1%20Crystal%20Structure%20%26%20Atomic%20Bonding%0A%20%20%20%20-%20**Covalent%20bond**%3A%20A%20bond%20between%202%20atoms%20is%20formed%20by%20sharing%20a%20pair%20of%20electrons%0A%20%20%20%20-%20**Co-ordination%20number**%3A%20Number%20of%20atoms%20directly%20bonded%20to%20an%20atom%0A%0A%20%20%20%20-%20Examples%0A%20%20%20%20%20%20%20%20-%20Si%20(atomic%20number%2014%2C%20Group%20IV)%20has%204%20outermost%20electrons%20available%20for%20bonding%0A%20%20%20%20%20%20%20%20%20%20%20%20-%20Forms%20covalent%20bonds%20with%204%20other%20Si%20atoms%0A%20%20%20%20%20%20%20%20%20%20%20%20-%20In%20the%20diamond%20lattice%2C%20each%20atom%20has%204%20nearest%20neighbours.%20Coordination%20number%20%3D%204%0A%20%20%20%20%20%20%20%20-%20Indium%20(Group%20III)%20has%203%20valence%20electrons%20bond%20with%20Phosphorus%20(Group%20V)%20with%205%20valence%20electrons%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20mo.image(src%3DIMAGE_DIR%20%2F%20%22diamond_coordinates.jpg%22%2C%20width%3D%2260%25%22)%0A%20%20%20%20%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(IMAGE_DIR%2C%20mo)%3A%0A%20%20%20%20%23%20Common%20semiconductor%20materials%0A%20%20%20%20mo.image(src%3DIMAGE_DIR%20%2F%20%22semiconductormaterials.jpg%22%2C%20width%3D800)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%207.%20Density%0A%0A%20%20%20%20%24%24%5Ctext%7BDensity%7D%20%3D%20%5Cfrac%7B%5Ctext%7BNumber%20of%20atoms%2Fcm%7D%5E3%20%5Ctimes%20%5Ctext%7BAtomic%20weight%20(g%2Fmol)%7D%7D%7B%5Ctext%7BAvogadro's%20number%7D%7D%24%24%0A%0A%20%20%20%20where%20Avogadro's%20number%20%3D%20%246.02%20%5Ctimes%2010%5E%7B23%7D%24%20atoms%2Fmol%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%23%20Interactive%20density%20calculator%0A%20%20%20%20def%20_calculate_density(lattice_constant_nm%2C%20atoms_per_cell%2C%20atomic_weight)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Calculate%20density%20of%20a%20crystalline%20material.%22%22%22%0A%20%20%20%20%20%20%20%20a_cm%20%3D%20lattice_constant_nm%20*%201e-7%20%20%23%20nm%20to%20cm%0A%20%20%20%20%20%20%20%20volume_cm3%20%3D%20a_cm%20**%203%0A%20%20%20%20%20%20%20%20atoms_per_cm3%20%3D%20atoms_per_cell%20%2F%20volume_cm3%0A%20%20%20%20%20%20%20%20avogadro%20%3D%206.022e23%0A%20%20%20%20%20%20%20%20density%20%3D%20atoms_per_cm3%20*%20atomic_weight%20%2F%20avogadro%0A%20%20%20%20%20%20%20%20return%20atoms_per_cm3%2C%20density%0A%0A%20%20%20%20%23%20Material%20database%0A%20%20%20%20_materials%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%22Silicon%20(Si)%20-%20Diamond%22%3A%20%7B%22lattice_constant%22%3A%200.543%2C%20%22atoms_per_cell%22%3A%208%2C%20%22atomic_weight%22%3A%2028.086%7D%2C%0A%20%20%20%20%20%20%20%20%22Germanium%20(Ge)%20-%20Diamond%22%3A%20%7B%22lattice_constant%22%3A%200.566%2C%20%22atoms_per_cell%22%3A%208%2C%20%22atomic_weight%22%3A%2072.63%7D%2C%0A%20%20%20%20%20%20%20%20%22Carbon%20(C)%20-%20Diamond%22%3A%20%7B%22lattice_constant%22%3A%200.357%2C%20%22atoms_per_cell%22%3A%208%2C%20%22atomic_weight%22%3A%2012.011%7D%2C%0A%20%20%20%20%20%20%20%20%22Gold%20(Au)%20-%20FCC%22%3A%20%7B%22lattice_constant%22%3A%200.408%2C%20%22atoms_per_cell%22%3A%204%2C%20%22atomic_weight%22%3A%20196.967%7D%2C%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%20Create%20a%20table%20showing%20all%20material%20properties%20including%20calculated%20density%0A%20%20%20%20_material_table%20%3D%20%22%22%22%0A%20%20%20%20%7C%20Material%20-%20Lattice%20%7C%20Lattice%20Constant%20(nm)%20%7C%20Atoms%20per%20Unit%20Cell%20%7C%20Atomic%20Weight%20(g%2Fmol)%20%7C%20Density%20(g%2Fcm%C2%B3)%20%7C%0A%20%20%20%20%7C%3A---------%7C%3A---------------------%3A%7C%3A--------------%3A%7C%3A---------------------%3A%7C%3A---------------%3A%7C%0A%20%20%20%20%22%22%22%0A%0A%20%20%20%20for%20_mat_name%2C%20_mat_props%20in%20_materials.items()%3A%0A%20%20%20%20%20%20%20%20_atoms_per_cm3%2C%20_density%20%3D%20_calculate_density(%0A%20%20%20%20%20%20%20%20%20%20%20%20_mat_props%5B'lattice_constant'%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20_mat_props%5B'atoms_per_cell'%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20_mat_props%5B'atomic_weight'%5D%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20_material_table%20%2B%3D%20f%22%7C%20%7B_mat_name%7D%20%7C%20%7B_mat_props%5B'lattice_constant'%5D%7D%20%7C%20%7B_mat_props%5B'atoms_per_cell'%5D%7D%20%7C%20%7B_mat_props%5B'atomic_weight'%5D%7D%20%7C%20%7B_density%3A.2f%7D%20%7C%5Cn%22%0A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%207.1%20Examples%22)%2C%0A%20%20%20%20%20%20%20%20mo.md(_material_table)%2C%0A%20%20%20%20%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(IMAGE_DIR%2C%20mo)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%208.%20Miller%20Indices%0A%0A%20%20%20%20A%20system%20for%20labeling%20**planes**%20and%20**directions**%20in%20crystals.%0A%0A%20%20%20%20%23%23%23%208.1%20Recipe%20for%20Planes%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%201.%20Set%20up%20axes%20along%20unit%20cell%0A%20%20%20%202.%20Identify%20intercepts%20in%20terms%20of%20lattice%20constant%3A%20e.g.%2C%20%24(a%2C%203a%2C%202a)%24%0A%20%20%20%203.%20Take%20reciprocals%3A%20%24(1%2C%20%5Cfrac%7B1%7D%7B3%7D%2C%20%5Cfrac%7B1%7D%7B2%7D)%24%0A%20%20%20%204.%20Multiply%20by%20lowest%20common%20multiple%20to%20form%20integers%3A%20%24(6%2C%202%2C%203)%24%0A%20%20%20%205.%20Enclose%20in%20round%20brackets%3A%20**(623)**%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.image(src%3DIMAGE_DIR%20%2F%20%22miller_plane_623.jpg%22%2C%20width%3D300)%0A%20%20%20%20%20%20%20%20%5D%2C%20justify%3D%22start%22%2C%20align%3D%22center%22%2C%20gap%3D2)%0A%20%20%20%20%5D%2C%20align%3D%22start%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(IMAGE_DIR%2C%20mo)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%208.2%20Special%20Cases%0A%0A%20%20%20%20-%20**No%20intercept**%3A%20Take%20intercept%20at%20infinity.%20Therefore%2C%20reciprocal%20%3D%200%0A%20%20%20%20%20%20-%20E.g.%2C%20plane%20parallel%20to%20z-axis%3A%20%24(hk0)%24%0A%20%20%20%20-%20**Negative%20values**%3A%20Use%20overbar%20notation%3A%20%24(%5Cbar%7B1%7D00)%24%0A%20%20%20%20-%20**Family%20of%20equivalent%20planes**%3A%20Use%20curly%20brackets%0A%20%20%20%20%20%20%20%20-%20E.g.%2C%20in%20a%20cubic%20lattice%20(100)%2C%20(010)%2C%20(001)%2C%20%24(%5Cbar%7B1%7D00)%24%2C%20%24(0%5Cbar%7B1%7D0)%24%2C%20%24(00%5Cbar%7B1%7D)%24%20planes%20are%20equivalent%20%0A%20%20%20%20%20%20%20%20-%20This%20is%20the%20%20%24%5C%7B100%5C%7D%24%20family%20of%20planes%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20mo.hstack(%5Bmo.md(%22**Examples%20of%20planes%20in%20cubic%20crystals**%22)%5D)%2C%0A%20%20%20%20%20%20%20%20mo.image(src%3DIMAGE_DIR%20%2F%20%22miller_planes_100_110_111.jpg%22%2C%20width%3D%2260%25%22)%0A%20%20%20%20%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%208.3%20Miller%20Indices%20for%20Directions%0A%0A%20%20%20%20-%20Direction%3A%20%24%5Cvec%7Br%7D%20%3D%20h%5Cvec%7Ba%7D_1%20%2B%20k%5Cvec%7Ba%7D_2%20%2B%20l%5Cvec%7Ba%7D_3%24%0A%20%20%20%20-%20Notation%3A%20**%5Bhkl%5D**%20(square%20brackets)%0A%20%20%20%20-%20Equivalent%20directions%3A%20**%E2%9F%A8hkl%E2%9F%A9**%20(angle%20brackets)%0A%0A%20%20%20%20-%20**USEFUL%3A**%20In%20cubic%20crystals%2C%20the%20direction%20**%5Bhkl%5D**%20is%20**perpendicular**%20to%20the%20plane%20**(hkl)**.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np%2C%20plt)%3A%0A%20%20%20%20fig%2C%20ax%20%3D%20plt.subplots(figsize%3D(4%2C%204))%0A%0A%20%20%20%20%23%20Origin%0A%20%20%20%20origin%20%3D%20np.array(%5B0.15%2C%200.15%5D)%0A%0A%20%20%20%20%23%20Axis%20endpoints%0A%20%20%20%20x_end%20%3D%20np.array(%5B0.85%2C%200.15%5D)%0A%20%20%20%20y_end%20%3D%20np.array(%5B0.75%2C%200.45%5D)%0A%20%20%20%20z_end%20%3D%20np.array(%5B0.15%2C%200.85%5D)%0A%0A%20%20%20%20%23%20Intercept%20points%20on%20axes%0A%20%20%20%20x_int%20%3D%20origin%20%2B%200.5%20*%20(x_end%20-%20origin)%20%20%23%20m%2Fh%20on%20x%0A%20%20%20%20y_int%20%3D%20origin%20%2B%200.7%20*%20(y_end%20-%20origin)%20%20%23%20m%2Fk%20on%20y%0A%20%20%20%20z_int%20%3D%20origin%20%2B%200.6%20*%20(z_end%20-%20origin)%20%20%23%20m%2Fl%20on%20z%0A%0A%20%20%20%20%23%20Draw%20axes%20(black%20arrows)%0A%20%20%20%20arrow_props%20%3D%20dict(head_width%3D0.025%2C%20head_length%3D0.02%2C%20fc%3D'black'%2C%20ec%3D'black'%2C%20linewidth%3D1.5)%0A%20%20%20%20ax.arrow(origin%5B0%5D%2C%20origin%5B1%5D%2C%20(x_end%20-%20origin)%5B0%5D*0.95%2C%20(x_end%20-%20origin)%5B1%5D%2C%20**arrow_props)%0A%20%20%20%20ax.arrow(origin%5B0%5D%2C%20origin%5B1%5D%2C%20(y_end%20-%20origin)%5B0%5D*0.95%2C%20(y_end%20-%20origin)%5B1%5D*0.95%2C%20**arrow_props)%0A%20%20%20%20ax.arrow(origin%5B0%5D%2C%20origin%5B1%5D%2C%20(z_end%20-%20origin)%5B0%5D%2C%20(z_end%20-%20origin)%5B1%5D*0.95%2C%20**arrow_props)%0A%0A%20%20%20%20%23%20Axis%20labels%0A%20%20%20%20ax.text(x_end%5B0%5D%20%2B%200.03%2C%20x_end%5B1%5D%2C%20r'%24x%24'%2C%20fontsize%3D14%2C%20ha%3D'left'%2C%20va%3D'center')%0A%20%20%20%20ax.text(y_end%5B0%5D%20%2B%200.03%2C%20y_end%5B1%5D%20%2B%200.02%2C%20r'%24y%24'%2C%20fontsize%3D14%2C%20ha%3D'left'%2C%20va%3D'center')%0A%20%20%20%20ax.text(z_end%5B0%5D%2C%20z_end%5B1%5D%20%2B%200.05%2C%20r'%24z%24'%2C%20fontsize%3D14%2C%20ha%3D'center'%2C%20va%3D'bottom')%0A%0A%20%20%20%20%23%20Draw%20the%20triangular%20plane%20(filled)%0A%20%20%20%20triangle%20%3D%20plt.Polygon(%5Bx_int%2C%20y_int%2C%20z_int%5D%2C%20fill%3DTrue%2C%20facecolor%3D'lightgray'%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20edgecolor%3D'black'%2C%20linewidth%3D2%2C%20alpha%3D0.7)%0A%20%20%20%20ax.add_patch(triangle)%0A%0A%20%20%20%20%23%20Draw%20red%20vectors%20v1%20and%20v2%20on%20the%20plane%0A%20%20%20%20%23%20v1%3A%20from%20z_int%20to%20x_int%0A%20%20%20%20ax.annotate(''%2C%20xy%3Dx_int%2C%20xytext%3Dz_int%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20arrowprops%3Ddict(arrowstyle%3D'-%3E'%2C%20color%3D'%23C44536'%2C%20lw%3D2.5))%0A%20%20%20%20%23%20v2%3A%20from%20y_int%20to%20x_int%20%20%0A%20%20%20%20ax.annotate(''%2C%20xy%3Dx_int%2C%20xytext%3Dy_int%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20arrowprops%3Ddict(arrowstyle%3D'-%3E'%2C%20color%3D'%23C44536'%2C%20lw%3D2.5))%0A%0A%20%20%20%20%23%20Intercept%20labels%0A%20%20%20%20ax.text(x_int%5B0%5D%2C%20x_int%5B1%5D%20-%200.06%2C%20r'%24%5Cfrac%7Bm%7D%7Bh%7D%24'%2C%20fontsize%3D13%2C%20ha%3D'center'%2C%20va%3D'top')%0A%20%20%20%20ax.text(y_int%5B0%5D%20%2B%200.05%2C%20y_int%5B1%5D%2C%20r'%24%5Cfrac%7Bm%7D%7Bk%7D%24'%2C%20fontsize%3D13%2C%20ha%3D'left'%2C%20va%3D'center')%0A%20%20%20%20ax.text(z_int%5B0%5D%20-%200.05%2C%20z_int%5B1%5D%2C%20r'%24%5Cfrac%7Bm%7D%7Bl%7D%24'%2C%20fontsize%3D13%2C%20ha%3D'right'%2C%20va%3D'center')%0A%0A%20%20%20%20%23%20Vector%20labels%0A%20%20%20%20v1_mid%20%3D%200.5%20*%20(z_int%20%2B%20x_int)%0A%20%20%20%20v2_mid%20%3D%200.5%20*%20(y_int%20%2B%20x_int)%0A%20%20%20%20ax.text(v1_mid%5B0%5D%20-%200.02%2C%20v1_mid%5B1%5D%20%2B%200.06%2C%20r'%24%5Cvec%7Bv%7D_1%20%3D%20%5Cleft(%5Cfrac%7Bm%7D%7Bh%7D%5Cvec%7Ba%7D_1%20-%20%5Cfrac%7Bm%7D%7Bl%7D%5Cvec%7Ba%7D_3%5Cright)%24'%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20fontsize%3D10%2C%20ha%3D'center'%2C%20va%3D'bottom')%0A%20%20%20%20ax.text(v2_mid%5B0%5D%20%2B%200.12%2C%20v2_mid%5B1%5D%20-%200.03%2C%20r'%24%5Cvec%7Bv%7D_2%20%3D%20%5Cleft(%5Cfrac%7Bm%7D%7Bh%7D%5Cvec%7Ba%7D_1%20-%20%5Cfrac%7Bm%7D%7Bk%7D%5Cvec%7Ba%7D_2%5Cright)%24'%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20fontsize%3D10%2C%20ha%3D'left'%2C%20va%3D'top')%0A%0A%20%20%20%20ax.set_xlim(0%2C%201)%0A%20%20%20%20ax.set_ylim(0%2C%201)%0A%20%20%20%20ax.set_aspect('equal')%0A%20%20%20%20ax.axis('off')%0A%0A%20%20%20%20plt.tight_layout()%0A%20%20%20%20miller_proof_fig%20%3D%20fig%0A%20%20%20%20return%20(miller_proof_fig%2C)%0A%0A%0A%40app.cell%0Adef%20_(miller_proof_fig%2C%20mo)%3A%0A%20%20%20%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%208.4%20Proof%3A%20%24(hkl)%24%20is%20normal%20to%20%24%5Bhkl%5D%24%0A%0A%20%20%20%201.%20Find%20intercepts%20of%20the%20plane%20%24(hkl)%24%0A%20%20%20%20%20%20%20-%20%24m%24%20is%20an%20integer%0A%20%20%20%20%20%20%20-%20Intercepts%20are%20at%20%24%5Cfrac%7Bm%7D%7Bh%7D%24%2C%20%24%5Cfrac%7Bm%7D%7Bk%7D%24%2C%20%24%5Cfrac%7Bm%7D%7Bl%7D%24%20along%20the%20%24x%24%2C%20%24y%24%2C%20%24z%24%20axes%0A%0A%20%20%20%202.%20Identify%202%20vectors%20on%20this%20plane%20%E2%80%94%20Any%20vector%20can%20be%20expressed%20as%20a%20linear%20superposition%20of%20two%20vectors%3A%20%24%5Cvec%7Bv%7D_1%20%3D%20%5Cleft(%5Cfrac%7Bm%7D%7Bh%7D%5Cvec%7Ba%7D_1%20-%20%5Cfrac%7Bm%7D%7Bl%7D%5Cvec%7Ba%7D_3%5Cright)%24%20and%20%24%5Cvec%7Bv%7D_2%20%3D%20%5Cleft(%5Cfrac%7Bm%7D%7Bh%7D%5Cvec%7Ba%7D_1%20-%20%5Cfrac%7Bm%7D%7Bk%7D%5Cvec%7Ba%7D_2%5Cright)%24%0A%0A%20%20%20%203.%20An%20arbitrary%20vector%20on%20%24(hkl)%24%20is%20%24%5Cvec%7Bs%7D%20%3D%20n_1%5Cvec%7Bv%7D_1%20%2B%20n_2%5Cvec%7Bv%7D_2%24%0A%0A%20%20%20%204.%20Dot%20product%20with%20direction%20%24%5Bhkl%5D%24%3A%20%24%5Cvec%7Bs%7D%20%5Ccdot%20(h%5Cvec%7Ba%7D_1%20%2B%20k%5Cvec%7Ba%7D_2%20%2B%20l%5Cvec%7Ba%7D_3)%20%3D%200%24%0A%0A%20%20%20%205.%20Since%20any%20vector%20on%20%24(hkl)%24%20is%20perpendicular%20to%20%24%5Bhkl%5D%24%2C%20the%20plane%20%24(hkl)%24%20is%20normal%20to%20%24%5Bhkl%5D%24.%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20miller_proof_fig%0A%20%20%20%20%5D%2C%20justify%3D%22space-between%22%2C%20align%3D%22center%22%2C%20widths%3D%5B0.6%2C%200.4%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%208.5%20Useful%20Formulas%0A%0A%20%20%20%20-%20%20Angle%20between%20two%20directions%20%24%5Bx_1%20%5C%2C%20y_1%20%5C%2C%20z_1%5D%24%20and%20%24%5Bx_2%20%5C%2C%20y_2%20%5C%2C%20z_2%5D%24%3A%0A%0A%20%20%20%20%24%24%5Ccos(%5Calpha)%20%3D%20%5Cfrac%7Bx_1%20x_2%20%2B%20y_1%20y_2%20%2B%20z_1%20z_2%7D%7B%5Csqrt%7Bx_1%5E2%20%2B%20y_1%5E2%20%2B%20z_1%5E2%7D%20%5Ccdot%20%5Csqrt%7Bx_2%5E2%20%2B%20y_2%5E2%20%2B%20z_2%5E2%7D%7D%24%24%0A%0A%20%20%20%20-%20Example%3A%20Angle%20between%20%5B100%5D%20and%20%5B110%5D%20is%2045%C2%B0%0A%0A%0A%20%20%20%20-%20Distance%20between%20adjacent%20%20(hkl)%20planes%20in%20a%20cubic%20lattice%20with%20lattice%20constant%20%24a%24%3A%0A%0A%20%20%20%20%24%24d_%7B(hkl)%7D%20%3D%20%5Cfrac%7Ba%7D%7B%5Csqrt%7Bh%5E2%20%2B%20k%5E2%20%2B%20l%5E2%7D%7D%24%24%0A%0A%20%20%20%20-%20Examples%3A%0A%20%20%20%20%20%20%20%20-%20Distance%20between%20(100)%20planes%3A%20%24a%24%0A%20%20%20%20%20%20%20%20-%20Distance%20between%20(110)%20planes%3A%20%24a%2F%5Csqrt%7B2%7D%24%0A%20%20%20%20%20%20%20%20-%20Distance%20between%20(111)%20planes%3A%20%24a%2F%5Csqrt%7B3%7D%24%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(go%2C%20mo%2C%20np)%3A%0A%20%20%20%20def%20plot_miller_plane(h%2C%20k%2C%20l)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Plot%20the%20Miller%20indices%20plane%20in%20a%20unit%20cell%20by%20showing%20intercepts.%22%22%22%0A%20%20%20%20%20%20%20%20fig_miller%20%3D%20go.Figure()%0A%0A%20%20%20%20%20%20%20%20%23%20Draw%20unit%20cell%20edges%0A%20%20%20%20%20%20%20%20cube_edges%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20(%5B0%2C%201%5D%2C%20%5B0%2C%200%5D%2C%20%5B0%2C%200%5D)%2C%20(%5B0%2C%200%5D%2C%20%5B0%2C%201%5D%2C%20%5B0%2C%200%5D)%2C%20(%5B0%2C%200%5D%2C%20%5B0%2C%200%5D%2C%20%5B0%2C%201%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(%5B1%2C%201%5D%2C%20%5B0%2C%201%5D%2C%20%5B0%2C%200%5D)%2C%20(%5B1%2C%201%5D%2C%20%5B0%2C%200%5D%2C%20%5B0%2C%201%5D)%2C%20(%5B0%2C%201%5D%2C%20%5B1%2C%201%5D%2C%20%5B0%2C%200%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(%5B0%2C%200%5D%2C%20%5B1%2C%201%5D%2C%20%5B0%2C%201%5D)%2C%20(%5B0%2C%201%5D%2C%20%5B0%2C%200%5D%2C%20%5B1%2C%201%5D)%2C%20(%5B0%2C%200%5D%2C%20%5B0%2C%201%5D%2C%20%5B1%2C%201%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(%5B1%2C%201%5D%2C%20%5B1%2C%201%5D%2C%20%5B0%2C%201%5D)%2C%20(%5B1%2C%201%5D%2C%20%5B0%2C%201%5D%2C%20%5B1%2C%201%5D)%2C%20(%5B0%2C%201%5D%2C%20%5B1%2C%201%5D%2C%20%5B1%2C%201%5D)%0A%20%20%20%20%20%20%20%20%5D%0A%0A%20%20%20%20%20%20%20%20for%20edge%20in%20cube_edges%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dedge%5B0%5D%2C%20y%3Dedge%5B1%5D%2C%20z%3Dedge%5B2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%20line%3Ddict(color%3D'black'%2C%20width%3D2)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%20hoverinfo%3D'skip'%0A%20%20%20%20%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20%23%20Draw%20solid%20x%2C%20y%2C%20z%20axes%0A%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5B-2%2C%202%5D%2C%20y%3D%5B0%2C%200%5D%2C%20z%3D%5B0%2C%200%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%20line%3Ddict(color%3D'red'%2C%20width%3D4)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%20hoverinfo%3D'skip'%0A%20%20%20%20%20%20%20%20))%0A%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5B0%2C%200%5D%2C%20y%3D%5B-2%2C%202%5D%2C%20z%3D%5B0%2C%200%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%20line%3Ddict(color%3D'green'%2C%20width%3D4)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%20hoverinfo%3D'skip'%0A%20%20%20%20%20%20%20%20))%0A%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5B0%2C%200%5D%2C%20y%3D%5B0%2C%200%5D%2C%20z%3D%5B-2%2C%202%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%20line%3Ddict(color%3D'blue'%2C%20width%3D4)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%20hoverinfo%3D'skip'%0A%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20%23%20Add%20axes%20labels%0A%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5B2.2%5D%2C%20y%3D%5B0%5D%2C%20z%3D%5B0%5D%2C%20mode%3D'text'%2C%20text%3D%5B'x'%5D%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20textfont%3Ddict(size%3D14%2C%20color%3D'red')%2C%20showlegend%3DFalse%0A%20%20%20%20%20%20%20%20))%0A%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5B0%5D%2C%20y%3D%5B2.2%5D%2C%20z%3D%5B0%5D%2C%20mode%3D'text'%2C%20text%3D%5B'y'%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20textfont%3Ddict(size%3D14%2C%20color%3D'green')%2C%20showlegend%3DFalse%0A%20%20%20%20%20%20%20%20))%0A%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5B0%5D%2C%20y%3D%5B0%5D%2C%20z%3D%5B2.2%5D%2C%20mode%3D'text'%2C%20text%3D%5B'z'%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20textfont%3Ddict(size%3D14%2C%20color%3D'blue')%2C%20showlegend%3DFalse%0A%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20if%20h%20%3D%3D%200%20and%20k%20%3D%3D%200%20and%20l%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20fig_miller.add_annotation(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%3D%22Invalid%3A%20(0%2C0%2C0)%20is%20not%20a%20valid%20Miller%20index%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xref%3D%22paper%22%2C%20yref%3D%22paper%22%2C%20x%3D0.5%2C%20y%3D0.5%2C%20showarrow%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font%3Ddict(size%3D16%2C%20color%3D'red')%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Calculate%20intercepts%3A%20intercept%20%3D%201%2Findex%20(if%20index%20!%3D%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20x_int%20%3D%201.0%20%2F%20h%20if%20h%20!%3D%200%20else%20None%0A%20%20%20%20%20%20%20%20%20%20%20%20y_int%20%3D%201.0%20%2F%20k%20if%20k%20!%3D%200%20else%20None%0A%20%20%20%20%20%20%20%20%20%20%20%20z_int%20%3D%201.0%20%2F%20l%20if%20l%20!%3D%200%20else%20None%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Collect%20valid%20intercept%20points%20for%20the%20plane%0A%20%20%20%20%20%20%20%20%20%20%20%20intercept_points%20%3D%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20x_int%20is%20not%20None%20and%20-2%20%3C%3D%20x_int%20%3C%3D%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5Bx_int%5D%2C%20y%3D%5B0%5D%2C%20z%3D%5B0%5D%2C%20mode%3D'markers'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker%3Ddict(size%3D10%2C%20color%3D'red')%2C%20name%3Df'x-intercept%3A%20%7Bx_int%3A.2f%7Da'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20intercept_points.append(%5Bx_int%2C%200%2C%200%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20y_int%20is%20not%20None%20and%20-2%20%3C%3D%20y_int%20%3C%3D%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5B0%5D%2C%20y%3D%5By_int%5D%2C%20z%3D%5B0%5D%2C%20mode%3D'markers'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker%3Ddict(size%3D10%2C%20color%3D'green')%2C%20name%3Df'y-intercept%3A%20%7By_int%3A.2f%7Da'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20intercept_points.append(%5B0%2C%20y_int%2C%200%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20z_int%20is%20not%20None%20and%20-2%20%3C%3D%20z_int%20%3C%3D%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5B0%5D%2C%20y%3D%5B0%5D%2C%20z%3D%5Bz_int%5D%2C%20mode%3D'markers'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker%3Ddict(size%3D10%2C%20color%3D'blue')%2C%20name%3Df'z-intercept%3A%20%7Bz_int%3A.2f%7Da'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20intercept_points.append(%5B0%2C%200%2C%20z_int%5D)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Draw%20the%20plane%20by%20connecting%20intercepts%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20len(intercept_points)%20%3D%3D%203%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Three%20intercepts%3A%20draw%20a%20triangular%20plane%20using%20Mesh3d%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pts%20%3D%20np.array(intercept_points)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Mesh3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dpts%5B%3A%2C%200%5D%2C%20y%3Dpts%5B%3A%2C%201%5D%2C%20z%3Dpts%5B%3A%2C%202%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20i%3D%5B0%5D%2C%20j%3D%5B1%5D%2C%20k%3D%5B2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20opacity%3D0.6%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3D'cyan'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3Df'(%7Bh%7D%7Bk%7D%7Bl%7D)%20plane'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DTrue%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Draw%20edges%20of%20the%20triangle%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20i%20in%20range(3)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20p1%20%3D%20intercept_points%5Bi%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20p2%20%3D%20intercept_points%5B(i%20%2B%201)%20%25%203%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5Bp1%5B0%5D%2C%20p2%5B0%5D%5D%2C%20y%3D%5Bp1%5B1%5D%2C%20p2%5B1%5D%5D%2C%20z%3D%5Bp1%5B2%5D%2C%20p2%5B2%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%20line%3Ddict(color%3D'darkblue'%2C%20width%3D4)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%20hoverinfo%3D'skip'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20))%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20len(intercept_points)%20%3D%3D%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Two%20intercepts%20(one%20index%20is%200)%3A%20plane%20is%20parallel%20to%20one%20axis%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Draw%20a%20rectangular%20plane%20extending%20in%20the%20direction%20of%20the%20zero%20index%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20p1%2C%20p2%20%3D%20intercept_points%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Determine%20which%20axis%20has%20zero%20index%20(plane%20extends%20infinitely%20along%20it)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20h%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Plane%20parallel%20to%20x-axis%2C%20extend%20in%20x%20direction%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vertices%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bp1%5B0%5D%20-%202%2C%20p1%5B1%5D%2C%20p1%5B2%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bp1%5B0%5D%20%2B%202%2C%20p1%5B1%5D%2C%20p1%5B2%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bp2%5B0%5D%20%2B%202%2C%20p2%5B1%5D%2C%20p2%5B2%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bp2%5B0%5D%20-%202%2C%20p2%5B1%5D%2C%20p2%5B2%5D%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20k%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Plane%20parallel%20to%20y-axis%2C%20extend%20in%20y%20direction%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vertices%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bp1%5B0%5D%2C%20p1%5B1%5D%20-%202%2C%20p1%5B2%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bp1%5B0%5D%2C%20p1%5B1%5D%20%2B%202%2C%20p1%5B2%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bp2%5B0%5D%2C%20p2%5B1%5D%20%2B%202%2C%20p2%5B2%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bp2%5B0%5D%2C%20p2%5B1%5D%20-%202%2C%20p2%5B2%5D%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%20%20%23%20l%20%3D%3D%200%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Plane%20parallel%20to%20z-axis%2C%20extend%20in%20z%20direction%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vertices%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bp1%5B0%5D%2C%20p1%5B1%5D%2C%20p1%5B2%5D%20-%202%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bp1%5B0%5D%2C%20p1%5B1%5D%2C%20p1%5B2%5D%20%2B%202%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bp2%5B0%5D%2C%20p2%5B1%5D%2C%20p2%5B2%5D%20%2B%202%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bp2%5B0%5D%2C%20p2%5B1%5D%2C%20p2%5B2%5D%20-%202%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20verts%20%3D%20np.array(vertices)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Mesh3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dverts%5B%3A%2C%200%5D%2C%20y%3Dverts%5B%3A%2C%201%5D%2C%20z%3Dverts%5B%3A%2C%202%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20i%3D%5B0%2C%200%5D%2C%20j%3D%5B1%2C%202%5D%2C%20k%3D%5B2%2C%203%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20opacity%3D0.6%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3D'cyan'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3Df'(%7Bh%7D%7Bk%7D%7Bl%7D)%20plane'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DTrue%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Draw%20the%20line%20connecting%20the%20two%20intercepts%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5Bp1%5B0%5D%2C%20p2%5B0%5D%5D%2C%20y%3D%5Bp1%5B1%5D%2C%20p2%5B1%5D%5D%2C%20z%3D%5Bp1%5B2%5D%2C%20p2%5B2%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%20line%3Ddict(color%3D'darkblue'%2C%20width%3D4)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%20hoverinfo%3D'skip'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20))%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20len(intercept_points)%20%3D%3D%201%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20One%20intercept%20(two%20indices%20are%200)%3A%20plane%20perpendicular%20to%20one%20axis%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20p%20%3D%20intercept_points%5B0%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20h%20!%3D%200%3A%20%20%23%20Plane%20perpendicular%20to%20x-axis%20(yz%20plane%20at%20x%20%3D%201%2Fh)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vertices%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bp%5B0%5D%2C%20-2%2C%20-2%5D%2C%20%5Bp%5B0%5D%2C%202%2C%20-2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bp%5B0%5D%2C%202%2C%202%5D%2C%20%5Bp%5B0%5D%2C%20-2%2C%202%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20k%20!%3D%200%3A%20%20%23%20Plane%20perpendicular%20to%20y-axis%20(xz%20plane%20at%20y%20%3D%201%2Fk)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vertices%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B-2%2C%20p%5B1%5D%2C%20-2%5D%2C%20%5B2%2C%20p%5B1%5D%2C%20-2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B2%2C%20p%5B1%5D%2C%202%5D%2C%20%5B-2%2C%20p%5B1%5D%2C%202%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%20%20%23%20l%20!%3D%200%2C%20plane%20perpendicular%20to%20z-axis%20(xy%20plane%20at%20z%20%3D%201%2Fl)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vertices%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B-2%2C%20-2%2C%20p%5B2%5D%5D%2C%20%5B2%2C%20-2%2C%20p%5B2%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B2%2C%202%2C%20p%5B2%5D%5D%2C%20%5B-2%2C%202%2C%20p%5B2%5D%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20verts%20%3D%20np.array(vertices)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Mesh3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dverts%5B%3A%2C%200%5D%2C%20y%3Dverts%5B%3A%2C%201%5D%2C%20z%3Dverts%5B%3A%2C%202%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20i%3D%5B0%2C%200%5D%2C%20j%3D%5B1%2C%202%5D%2C%20k%3D%5B2%2C%203%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20opacity%3D0.6%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3D'cyan'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3Df'(%7Bh%7D%7Bk%7D%7Bl%7D)%20plane'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DTrue%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Draw%20normal%20vector%20from%20center%20of%20unit%20cell%0A%20%20%20%20%20%20%20%20%20%20%20%20normal%20%3D%20np.array(%5Bh%2C%20k%2C%20l%5D%2C%20dtype%3Dfloat)%0A%20%20%20%20%20%20%20%20%20%20%20%20normal_length%20%3D%20np.linalg.norm(normal)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20normal_length%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20normal_unit%20%3D%20normal%20%2F%20normal_length%20*%200.5%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20center%20%3D%20np.array(%5B0.5%2C%200.5%2C%200.5%5D)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5Bcenter%5B0%5D%2C%20center%5B0%5D%20%2B%20normal_unit%5B0%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D%5Bcenter%5B1%5D%2C%20center%5B1%5D%20%2B%20normal_unit%5B1%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3D%5Bcenter%5B2%5D%2C%20center%5B2%5D%20%2B%20normal_unit%5B2%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%20line%3Ddict(color%3D'magenta'%2C%20width%3D5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3Df'Normal%20%5B%7Bh%7D%7Bk%7D%7Bl%7D%5D'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fig_miller.add_trace(go.Cone(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5Bcenter%5B0%5D%20%2B%20normal_unit%5B0%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D%5Bcenter%5B1%5D%20%2B%20normal_unit%5B1%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3D%5Bcenter%5B2%5D%20%2B%20normal_unit%5B2%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20u%3D%5Bnormal_unit%5B0%5D%20*%200.3%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20v%3D%5Bnormal_unit%5B1%5D%20*%200.3%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20w%3D%5Bnormal_unit%5B2%5D%20*%200.3%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorscale%3D%5B%5B0%2C%20'magenta'%5D%2C%20%5B1%2C%20'magenta'%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showscale%3DFalse%2C%20sizemode%3D'absolute'%2C%20sizeref%3D0.1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20if%20h%20!%3D%200%20or%20k%20!%3D%200%20or%20l%20!%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20d_spacing%20%3D%201.0%20%2F%20np.sqrt(h**2%20%2B%20k**2%20%2B%20l**2)%0A%20%20%20%20%20%20%20%20%20%20%20%20title_text%20%3D%20f'Plane%20(%7Bh%7D%7Bk%7D%7Bl%7D)%20%7C%20Interplane%20spacing%20%3D%20%7Bd_spacing%3A.3f%7Da'%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20title_text%20%3D%20'Miller%20Plane%20Calculator'%0A%0A%20%20%20%20%20%20%20%20fig_miller.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Ddict(text%3Dtitle_text%2C%20x%3D0.5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scene%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xaxis_title%3D'x%20%5Ba%5D'%2C%20yaxis_title%3D'y%20%5Ba%5D'%2C%20zaxis_title%3D'z%20%5Ba%5D'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20aspectmode%3D'cube'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20camera%3Ddict(eye%3Ddict(x%3D1.8%2C%20y%3D1.8%2C%20z%3D1.2))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xaxis%3Ddict(range%3D%5B-0.5%2C%201.5%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yaxis%3Ddict(range%3D%5B-0.5%2C%201.5%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zaxis%3Ddict(range%3D%5B-0.5%2C%201.5%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D600%2C%20width%3D700%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3Ddict(l%3D0%2C%20r%3D0%2C%20t%3D50%2C%20b%3D0)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20return%20fig_miller%0A%0A%20%20%20%20h_input%20%3D%20mo.ui.slider(value%3D1%2C%20start%3D-3%2C%20stop%3D3%2C%20step%3D1%2C%20label%3D%22h%22)%0A%20%20%20%20k_input%20%3D%20mo.ui.slider(value%3D1%2C%20start%3D-3%2C%20stop%3D3%2C%20step%3D1%2C%20label%3D%22k%22)%0A%20%20%20%20l_input%20%3D%20mo.ui.slider(value%3D1%2C%20start%3D-3%2C%20stop%3D3%2C%20step%3D1%2C%20label%3D%22l%22)%0A%20%20%20%20return%20h_input%2C%20k_input%2C%20l_input%2C%20plot_miller_plane%0A%0A%0A%40app.cell%0Adef%20_(h_input%2C%20k_input%2C%20l_input%2C%20mo%2C%20plot_miller_plane)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%208.6%20Interactive%20Miller%20Indices%22)%2C%0A%20%20%20%20%20%20%20%20mo.md(%22Enter%20the%20Miller%20indices%20(h%2C%20k%2C%20l)%20to%20visualize%20the%20crystal%20plane%3A%22)%2C%0A%20%20%20%20%20%20%20%20mo.hstack(%5Bh_input%2C%20k_input%2C%20l_input%5D%2C%20justify%3D%22start%22%2C%20gap%3D2)%2C%0A%20%20%20%20%20%20%20%20plot_miller_plane(h_input.value%2C%20k_input.value%2C%20l_input.value)%0A%20%20%20%20%5D%2C%20align%3D%22center%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%209.%20Volumetric%20Packing%20Fraction%20(APF)%0A%0A%20%20%20%20The%20**atomic%20packing%20factor%20(APF)**%20measures%20what%20fraction%20of%20the%20unit%20cell%20volume%20is%20occupied%20by%20atoms%20(modeled%20as%20hard%20spheres).%20We%20assume%20atoms%20touch%20along%20the%20closest-packed%20direction%3A%0A%0A%20%20%20%20%7C%20Lattice%20%7C%20Atoms%20touch%20along%20%7C%20Atomic%20radius%20%24r%24%20%7C%20APF%20%7C%0A%20%20%20%20%7C%3A--------%3A%7C%3A--------------%3A%7C%3A-----------------%3A%7C%3A----%3A%7C%0A%20%20%20%20%7C%20SC%20%20%20%20%20%20%7C%20Edge%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%24a%2F2%24%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%24%5Cpi%2F6%20%5Capprox%200.524%24%20%7C%0A%20%20%20%20%7C%20BCC%20%20%20%20%20%7C%20Body%20diagonal%20%20%20%20%20%7C%20%24%5Csqrt%7B3%7D%5C%2Ca%2F4%24%20%20%20%7C%20%24%5Cpi%5Csqrt%7B3%7D%2F8%20%5Capprox%200.680%24%20%7C%0A%20%20%20%20%7C%20FCC%20%20%20%20%20%7C%20Face%20diagonal%20%20%20%20%20%7C%20%24%5Csqrt%7B2%7D%5C%2Ca%2F4%24%20%20%20%7C%20%24%5Cpi%5Csqrt%7B2%7D%2F6%20%5Capprox%200.740%24%20%7C%0A%20%20%20%20%7C%20Diamond%20%7C%20%C2%BC%20body%20diagonal%20%20%20%7C%20%24%5Csqrt%7B3%7D%5C%2Ca%2F8%24%20%20%20%7C%20%24%5Cpi%5Csqrt%7B3%7D%2F16%20%5Capprox%200.340%24%20%7C%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(go%2C%20mo%2C%20np)%3A%0A%20%20%20%20def%20get_lattice_apf_info(lattice_type%2C%20a)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Return%20atomic%20radius%2C%20atoms%20per%20unit%20cell%2C%20and%20APF%20for%20the%20lattice.%22%22%22%0A%20%20%20%20%20%20%20%20if%20lattice_type%20%3D%3D%20'SC'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20r%20%3D%20a%20%2F%202%0A%20%20%20%20%20%20%20%20%20%20%20%20atoms_per_cell%20%3D%201%0A%20%20%20%20%20%20%20%20%20%20%20%20apf%20%3D%20np.pi%20%2F%206%0A%20%20%20%20%20%20%20%20elif%20lattice_type%20%3D%3D%20'BCC'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20r%20%3D%20np.sqrt(3)%20*%20a%20%2F%204%0A%20%20%20%20%20%20%20%20%20%20%20%20atoms_per_cell%20%3D%202%0A%20%20%20%20%20%20%20%20%20%20%20%20apf%20%3D%20np.pi%20*%20np.sqrt(3)%20%2F%208%0A%20%20%20%20%20%20%20%20elif%20lattice_type%20%3D%3D%20'FCC'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20r%20%3D%20np.sqrt(2)%20*%20a%20%2F%204%0A%20%20%20%20%20%20%20%20%20%20%20%20atoms_per_cell%20%3D%204%0A%20%20%20%20%20%20%20%20%20%20%20%20apf%20%3D%20np.pi%20*%20np.sqrt(2)%20%2F%206%0A%20%20%20%20%20%20%20%20elif%20lattice_type%20%3D%3D%20'Diamond'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20r%20%3D%20np.sqrt(3)%20*%20a%20%2F%208%0A%20%20%20%20%20%20%20%20%20%20%20%20atoms_per_cell%20%3D%208%0A%20%20%20%20%20%20%20%20%20%20%20%20apf%20%3D%20np.pi%20*%20np.sqrt(3)%20%2F%2016%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20r%2C%20atoms_per_cell%2C%20apf%20%3D%20a%2F2%2C%201%2C%20np.pi%2F6%0A%20%20%20%20%20%20%20%20return%20r%2C%20atoms_per_cell%2C%20apf%0A%0A%0A%20%20%20%20def%20create_apf_figure(lattice_type%3D'SC'%2C%20a%3D1.0%2C%20show_spheres%3DTrue)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Create%20a%20plotly%20figure%20for%20APF%20visualization.%22%22%22%0A%20%20%20%20%20%20%20%20r%2C%20atoms_per_cell%2C%20apf_theory%20%3D%20get_lattice_apf_info(lattice_type%2C%20a)%0A%0A%20%20%20%20%20%20%20%20%23%20Get%20atom%20positions%20in%20one%20unit%20cell%0A%20%20%20%20%20%20%20%20if%20lattice_type%20%3D%3D%20'SC'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20positions%20%3D%20np.array(%5B%5B0%2C%200%2C%200%5D%2C%20%5Ba%2C%200%2C%200%5D%2C%20%5B0%2C%20a%2C%200%5D%2C%20%5B0%2C%200%2C%20a%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Ba%2C%20a%2C%200%5D%2C%20%5Ba%2C%200%2C%20a%5D%2C%20%5B0%2C%20a%2C%20a%5D%2C%20%5Ba%2C%20a%2C%20a%5D%5D)%0A%20%20%20%20%20%20%20%20elif%20lattice_type%20%3D%3D%20'BCC'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20corners%20%3D%20np.array(%5B%5B0%2C%200%2C%200%5D%2C%20%5Ba%2C%200%2C%200%5D%2C%20%5B0%2C%20a%2C%200%5D%2C%20%5B0%2C%200%2C%20a%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Ba%2C%20a%2C%200%5D%2C%20%5Ba%2C%200%2C%20a%5D%2C%20%5B0%2C%20a%2C%20a%5D%2C%20%5Ba%2C%20a%2C%20a%5D%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20center%20%3D%20np.array(%5B%5Ba%2F2%2C%20a%2F2%2C%20a%2F2%5D%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20positions%20%3D%20np.vstack(%5Bcorners%2C%20center%5D)%0A%20%20%20%20%20%20%20%20elif%20lattice_type%20%3D%3D%20'FCC'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20corners%20%3D%20np.array(%5B%5B0%2C%200%2C%200%5D%2C%20%5Ba%2C%200%2C%200%5D%2C%20%5B0%2C%20a%2C%200%5D%2C%20%5B0%2C%200%2C%20a%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Ba%2C%20a%2C%200%5D%2C%20%5Ba%2C%200%2C%20a%5D%2C%20%5B0%2C%20a%2C%20a%5D%2C%20%5Ba%2C%20a%2C%20a%5D%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20faces%20%3D%20np.array(%5B%5Ba%2F2%2C%20a%2F2%2C%200%5D%2C%20%5Ba%2F2%2C%20a%2F2%2C%20a%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Ba%2F2%2C%200%2C%20a%2F2%5D%2C%20%5Ba%2F2%2C%20a%2C%20a%2F2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B0%2C%20a%2F2%2C%20a%2F2%5D%2C%20%5Ba%2C%20a%2F2%2C%20a%2F2%5D%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20positions%20%3D%20np.vstack(%5Bcorners%2C%20faces%5D)%0A%20%20%20%20%20%20%20%20elif%20lattice_type%20%3D%3D%20'Diamond'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20corners%20%3D%20np.array(%5B%5B0%2C%200%2C%200%5D%2C%20%5Ba%2C%200%2C%200%5D%2C%20%5B0%2C%20a%2C%200%5D%2C%20%5B0%2C%200%2C%20a%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Ba%2C%20a%2C%200%5D%2C%20%5Ba%2C%200%2C%20a%5D%2C%20%5B0%2C%20a%2C%20a%5D%2C%20%5Ba%2C%20a%2C%20a%5D%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20faces%20%3D%20np.array(%5B%5Ba%2F2%2C%20a%2F2%2C%200%5D%2C%20%5Ba%2F2%2C%20a%2F2%2C%20a%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Ba%2F2%2C%200%2C%20a%2F2%5D%2C%20%5Ba%2F2%2C%20a%2C%20a%2F2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B0%2C%20a%2F2%2C%20a%2F2%5D%2C%20%5Ba%2C%20a%2F2%2C%20a%2F2%5D%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20fcc_pts%20%3D%20np.vstack(%5Bcorners%2C%20faces%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20basis_pts%20%3D%20fcc_pts%20%2B%20np.array(%5Ba%2F4%2C%20a%2F4%2C%20a%2F4%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20mask%20%3D%20np.all((basis_pts%20%3E%3D%20-1e-6)%20%26%20(basis_pts%20%3C%3D%20a%20%2B%201e-6)%2C%20axis%3D1)%0A%20%20%20%20%20%20%20%20%20%20%20%20basis_in%20%3D%20basis_pts%5Bmask%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20positions%20%3D%20np.vstack(%5Bfcc_pts%2C%20basis_in%5D)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20positions%20%3D%20np.array(%5B%5Ba%2F2%2C%20a%2F2%2C%20a%2F2%5D%5D)%0A%0A%20%20%20%20%20%20%20%20fig%20%3D%20go.Figure()%0A%0A%20%20%20%20%20%20%20%20%23%20Draw%20unit%20cell%20edges%0A%20%20%20%20%20%20%20%20edges%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20(%5B0%2C%20a%5D%2C%20%5B0%2C%200%5D%2C%20%5B0%2C%200%5D)%2C%20(%5B0%2C%200%5D%2C%20%5B0%2C%20a%5D%2C%20%5B0%2C%200%5D)%2C%20(%5B0%2C%200%5D%2C%20%5B0%2C%200%5D%2C%20%5B0%2C%20a%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(%5Ba%2C%20a%5D%2C%20%5B0%2C%20a%5D%2C%20%5B0%2C%200%5D)%2C%20(%5Ba%2C%20a%5D%2C%20%5B0%2C%200%5D%2C%20%5B0%2C%20a%5D)%2C%20(%5B0%2C%20a%5D%2C%20%5Ba%2C%20a%5D%2C%20%5B0%2C%200%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(%5B0%2C%200%5D%2C%20%5Ba%2C%20a%5D%2C%20%5B0%2C%20a%5D)%2C%20(%5B0%2C%20a%5D%2C%20%5B0%2C%200%5D%2C%20%5Ba%2C%20a%5D)%2C%20(%5B0%2C%200%5D%2C%20%5B0%2C%20a%5D%2C%20%5Ba%2C%20a%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(%5Ba%2C%20a%5D%2C%20%5Ba%2C%20a%5D%2C%20%5B0%2C%20a%5D)%2C%20(%5Ba%2C%20a%5D%2C%20%5B0%2C%20a%5D%2C%20%5Ba%2C%20a%5D)%2C%20(%5B0%2C%20a%5D%2C%20%5Ba%2C%20a%5D%2C%20%5Ba%2C%20a%5D)%0A%20%20%20%20%20%20%20%20%5D%0A%0A%20%20%20%20%20%20%20%20for%20edge%20in%20edges%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20fig.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dedge%5B0%5D%2C%20y%3Dedge%5B1%5D%2C%20z%3Dedge%5B2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%20line%3Ddict(color%3D'black'%2C%20width%3D2)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%20hoverinfo%3D'skip'%0A%20%20%20%20%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20if%20show_spheres%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Create%20sphere%20mesh%20for%20each%20atom%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20pos%20in%20positions%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20u_vals%20%3D%20np.linspace(0%2C%202%20*%20np.pi%2C%2020)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20v_vals%20%3D%20np.linspace(0%2C%20np.pi%2C%2015)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x_sphere%20%3D%20pos%5B0%5D%20%2B%20r%20*%20np.outer(np.cos(u_vals)%2C%20np.sin(v_vals)).flatten()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y_sphere%20%3D%20pos%5B1%5D%20%2B%20r%20*%20np.outer(np.sin(u_vals)%2C%20np.sin(v_vals)).flatten()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z_sphere%20%3D%20pos%5B2%5D%20%2B%20r%20*%20np.outer(np.ones(len(u_vals))%2C%20np.cos(v_vals)).flatten()%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fig.add_trace(go.Mesh3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dx_sphere%2C%20y%3Dy_sphere%2C%20z%3Dz_sphere%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alphahull%3D0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3D'steelblue'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20opacity%3D0.7%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20fig.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dpositions%5B%3A%2C%200%5D%2C%20y%3Dpositions%5B%3A%2C%201%5D%2C%20z%3Dpositions%5B%3A%2C%202%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'markers'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker%3Ddict(size%3D8%2C%20color%3D'steelblue'%2C%20line%3Ddict(color%3D'navy'%2C%20width%3D1))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%0A%20%20%20%20%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20fig.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%3Df'%7Blattice_type%7D%3A%20APF%20%3D%20%7Bapf_theory%3A.3f%7D%20(%7Bapf_theory*100%3A.1f%7D%25)%3Cbr%3E'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f'%3Csub%3Er%20%3D%20%7Br%3A.3f%7D%2C%20atoms%2Fcell%20%3D%20%7Batoms_per_cell%7D%20%7C%20Drag%20to%20rotate%3C%2Fsub%3E'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D0.5%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scene%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xaxis_title%3D'x'%2C%20yaxis_title%3D'y'%2C%20zaxis_title%3D'z'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20aspectmode%3D'cube'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20camera%3Ddict(eye%3Ddict(x%3D1.5%2C%20y%3D1.5%2C%20z%3D1.2))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xaxis%3Ddict(range%3D%5B-0.3*a%2C%201.3*a%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yaxis%3Ddict(range%3D%5B-0.3*a%2C%201.3*a%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zaxis%3Ddict(range%3D%5B-0.3*a%2C%201.3*a%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D500%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D600%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3Ddict(l%3D0%2C%20r%3D0%2C%20t%3D80%2C%20b%3D0)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20return%20fig%0A%0A%0A%20%20%20%20%23%20Create%20marimo%20UI%20controls%0A%20%20%20%20lattice_dropdown%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20options%3D%5B'SC'%2C%20'BCC'%2C%20'FCC'%2C%20'Diamond'%5D%2C%0A%20%20%20%20%20%20%20%20value%3D'SC'%2C%0A%20%20%20%20%20%20%20%20label%3D'Lattice%20Type'%0A%20%20%20%20)%0A%0A%20%20%20%20a_slider%20%3D%20mo.ui.slider(%0A%20%20%20%20%20%20%20%20start%3D0.5%2C%0A%20%20%20%20%20%20%20%20stop%3D2.0%2C%0A%20%20%20%20%20%20%20%20step%3D0.1%2C%0A%20%20%20%20%20%20%20%20value%3D1.0%2C%0A%20%20%20%20%20%20%20%20label%3D'Lattice%20constant%20a'%0A%20%20%20%20)%0A%0A%20%20%20%20display_dropdown%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20options%3D%7B'Spheres'%2C%20'Points'%7D%2C%0A%20%20%20%20%20%20%20%20value%3D'Spheres'%2C%0A%20%20%20%20%20%20%20%20label%3D'Display%20Mode'%0A%20%20%20%20)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20a_slider%2C%0A%20%20%20%20%20%20%20%20create_apf_figure%2C%0A%20%20%20%20%20%20%20%20display_dropdown%2C%0A%20%20%20%20%20%20%20%20get_lattice_apf_info%2C%0A%20%20%20%20%20%20%20%20lattice_dropdown%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20a_slider%2C%0A%20%20%20%20create_apf_figure%2C%0A%20%20%20%20display_dropdown%2C%0A%20%20%20%20get_lattice_apf_info%2C%0A%20%20%20%20lattice_dropdown%2C%0A%20%20%20%20mo%2C%0A)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%209.1%20Atomic%20Packing%20Factor%20(APF)%20Visualization%22)%2C%0A%20%20%20%20%20%20%20%20mo.hstack(%5Blattice_dropdown%2C%20a_slider%2C%20display_dropdown%5D%2C%20justify%3D%22start%22%2C%20gap%3D2)%2C%0A%20%20%20%20%20%20%20%20create_apf_figure(lattice_dropdown.value%2C%20a_slider.value%2C%20display_dropdown.value%20%3D%3D%20'Spheres')%2C%0A%20%20%20%20%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20**Lattice%3A**%20%7Blattice_dropdown.value%7D%20%20%0A%20%20%20%20**Lattice%20constant%20a%3A**%20%7Ba_slider.value%3A.3f%7D%20%20%0A%20%20%20%20**Atomic%20radius%20r%3A**%20%7Bget_lattice_apf_info(lattice_dropdown.value%2C%20a_slider.value)%5B0%5D%3A.4f%7D%20%20%0A%20%20%20%20**Atoms%20per%20unit%20cell%3A**%20%7Bget_lattice_apf_info(lattice_dropdown.value%2C%20a_slider.value)%5B1%5D%7D%20%20%0A%20%20%20%20**APF%3A**%20%7Bget_lattice_apf_info(lattice_dropdown.value%2C%20a_slider.value)%5B2%5D%3A.4f%7D%20%3D%20%7Bget_lattice_apf_info(lattice_dropdown.value%2C%20a_slider.value)%5B2%5D*100%3A.2f%7D%25%0A%20%20%20%20%22%22%22)%0A%20%20%20%20%5D%2C%20align%3D%22center%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%2010.%20Planar%20Packing%20Fraction%20in%20Miller%20Planes%0A%0A%20%20%20%20The%20**planar%20(areal)%20packing%20fraction**%20measures%20how%20densely%20atoms%20are%20packed%20in%20a%20particular%20crystal%20plane%3A%0A%0A%20%20%20%20%24%24%5Ctext%7BPlanar%20PF%7D%20%3D%20%5Cfrac%7Bn_%7B%5Ctext%7Batoms%7D%7D%20%5Ctimes%20%5Cpi%20r%5E2%7D%7BA_%7B%5Ctext%7B2D%20cell%7D%7D%7D%24%24%0A%0A%20%20%20%20where%20%24n_%7B%5Ctext%7Batoms%7D%7D%24%20is%20the%20number%20of%20atoms%20per%202D%20unit%20cell%20and%20%24A_%7B%5Ctext%7B2D%20cell%7D%7D%24%20is%20the%20area%20of%20that%20cell.%0A%0A%20%20%20%20**Example%20values%20for%20common%20planes%3A**%0A%0A%20%20%20%20%7C%20Lattice%20%7C%20Plane%20%7C%20%24n_%7B%5Ctext%7Batoms%7D%7D%24%7C%20r%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%24A_%7B%5Ctext%7B2D%7D%7D%24%20%7C%20Areal%20PF%20%7C%0A%20%20%20%20%7C%3A--------%3A%7C%3A-----%3A%7C%3A-----------------%3A%7C%3A---------------%3A%7C%3A---------------%3A%7C%3A--------%3A%7C%0A%20%20%20%20%7C%20FCC%20%20%20%20%20%7C%20(111)%20%7C%201%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%24%5Csqrt%7B2%7D%2F4%20a%24%20%7C%24%5Csqrt%7B3%7Da%5E2%2F4%24%20%7C%20%2090.7%25%20(close-packed)%20%7C%0A%20%20%20%20%7C%20FCC%20%20%20%20%20%7C%20(100)%20%7C%202%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%24%5Csqrt%7B2%7D%2F4%20a%24%20%20%7C%20%24a%5E2%24%20%20%20%20%20%20%20%20%20%20%20%7C%2078.5%25%20%7C%0A%20%20%20%20%7C%20FCC%20%20%20%20%20%7C%20(110)%20%7C%202%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%24%5Csqrt%7B2%7D%2F4%20a%24%20%20%7C%20%24%5Csqrt%7B2%7Da%5E2%24%20%20%20%7C%2055.5%25%20%7C%0A%20%20%20%20%7C%20BCC%20%20%20%20%20%7C%20(110)%20%7C%202%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%24%5Csqrt%7B3%7D%2F4%20a%24%20%20%7C%20%24%5Csqrt%7B2%7Da%5E2%24%20%20%20%7C%2083.3%25%20(close-packed)%20%7C%0A%20%20%20%20%7C%20BCC%20%20%20%20%20%7C%20(100)%20%7C%201%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%24%5Csqrt%7B3%7D%2F4%20a%24%20%7C%20%24a%5E2%24%20%20%20%20%20%20%20%20%20%20%20%7C%2058.9%25%20%7C%0A%20%20%20%20%7C%20BCC%20%20%20%20%20%7C%20(111)%20%7C%201%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%24%5Csqrt%7B3%7D%2F4%20a%24%20%7C%24%5Csqrt%7B3%7Da%5E2%24%20%20%20%7C%2034.0%25%20%7C%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(get_lattice_apf_info%2C%20mo%2C%20np)%3A%0A%20%20%20%20def%20get_plane_cell_intersection(h%2C%20k%2C%20l%2C%20a)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Find%20intersection%20polygon%20of%20plane%20hx%20%2B%20ky%20%2B%20lz%20%3D%20a%20with%20the%20unit%20cell%20%5B0%2Ca%5D%5E3.%22%22%22%0A%20%20%20%20%20%20%20%20if%20h%20%3D%3D%200%20and%20k%20%3D%3D%200%20and%20l%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20np.array(%5B%5D)%20%20%23%20Invalid%20plane%0A%0A%20%20%20%20%20%20%20%20%23%20Edges%20of%20the%20unit%20cell%3A%2012%20edges%2C%20each%20defined%20by%20a%20start%20point%20and%20direction%0A%20%20%20%20%20%20%20%20edges%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20fixed_dim%20in%20range(3)%3A%20%20%23%20Which%20dimension%20is%20fixed%20for%20this%20set%20of%20edges%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20v1%20in%20%5B0%2C%20a%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20v2%20in%20%5B0%2C%20a%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20start%20%3D%20%5B0%2C%200%2C%200%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20start%5Bfixed_dim%5D%20%3D%200%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20start%5B(fixed_dim%20%2B%201)%20%25%203%5D%20%3D%20v1%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20start%5B(fixed_dim%20%2B%202)%20%25%203%5D%20%3D%20v2%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20direction%20%3D%20%5B0%2C%200%2C%200%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20direction%5Bfixed_dim%5D%20%3D%20a%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20edges.append((np.array(start)%2C%20np.array(direction)))%0A%0A%20%20%20%20%20%20%20%20normal%20%3D%20np.array(%5Bh%2C%20k%2C%20l%5D%2C%20dtype%3Dfloat)%0A%20%20%20%20%20%20%20%20d%20%3D%20a%20%20%23%20Plane%20equation%3A%20h*x%20%2B%20k*y%20%2B%20l*z%20%3D%20a%0A%0A%20%20%20%20%20%20%20%20intersection_pts%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20start%2C%20direction%20in%20edges%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20denom%20%3D%20np.dot(normal%2C%20direction)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20abs(denom)%20%3C%201e-10%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%20%20%23%20Edge%20parallel%20to%20plane%0A%20%20%20%20%20%20%20%20%20%20%20%20t%20%3D%20(d%20-%20np.dot(normal%2C%20start))%20%2F%20denom%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20-1e-10%20%3C%3D%20t%20%3C%3D%201%20%2B%201e-10%3A%20%20%23%20Intersection%20within%20edge%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pt%20%3D%20start%20%2B%20t%20*%20direction%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Check%20if%20point%20is%20within%20unit%20cell%20bounds%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20all(-1e-10%20%3C%3D%20pt%5Bi%5D%20%3C%3D%20a%20%2B%201e-10%20for%20i%20in%20range(3))%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20intersection_pts.append(pt)%0A%0A%20%20%20%20%20%20%20%20if%20len(intersection_pts)%20%3C%203%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20np.array(%5B%5D)%0A%0A%20%20%20%20%20%20%20%20pts%20%3D%20np.array(intersection_pts)%0A%20%20%20%20%20%20%20%20%23%20Remove%20duplicate%20points%0A%20%20%20%20%20%20%20%20unique_pts%20%3D%20%5Bpts%5B0%5D%5D%0A%20%20%20%20%20%20%20%20for%20p%20in%20pts%5B1%3A%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20all(np.linalg.norm(p%20-%20u)%20%3E%201e-6%20for%20u%20in%20unique_pts)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20unique_pts.append(p)%0A%20%20%20%20%20%20%20%20pts%20%3D%20np.array(unique_pts)%0A%0A%20%20%20%20%20%20%20%20if%20len(pts)%20%3C%203%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20np.array(%5B%5D)%0A%0A%20%20%20%20%20%20%20%20%23%20Sort%20points%20to%20form%20a%20convex%20polygon%20(by%20angle%20around%20centroid)%0A%20%20%20%20%20%20%20%20centroid%20%3D%20pts.mean(axis%3D0)%0A%20%20%20%20%20%20%20%20%23%20Project%20onto%20plane%20and%20sort%20by%20angle%0A%20%20%20%20%20%20%20%20%23%20Use%20two%20basis%20vectors%20in%20the%20plane%0A%20%20%20%20%20%20%20%20v0%20%3D%20pts%5B0%5D%20-%20centroid%0A%20%20%20%20%20%20%20%20v0%20%3D%20v0%20%2F%20(np.linalg.norm(v0)%20%2B%201e-10)%0A%20%20%20%20%20%20%20%20v1%20%3D%20np.cross(normal%2C%20v0)%0A%20%20%20%20%20%20%20%20v1%20%3D%20v1%20%2F%20(np.linalg.norm(v1)%20%2B%201e-10)%0A%0A%20%20%20%20%20%20%20%20angles%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20p%20in%20pts%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20diff%20%3D%20p%20-%20centroid%0A%20%20%20%20%20%20%20%20%20%20%20%20angle%20%3D%20np.arctan2(np.dot(diff%2C%20v1)%2C%20np.dot(diff%2C%20v0))%0A%20%20%20%20%20%20%20%20%20%20%20%20angles.append(angle)%0A%0A%20%20%20%20%20%20%20%20sorted_idx%20%3D%20np.argsort(angles)%0A%20%20%20%20%20%20%20%20return%20pts%5Bsorted_idx%5D%0A%0A%20%20%20%20def%20generate_sc(n%2C%20a%3D1.0)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Simple%20cubic%20lattice%20points%20in%20an%20n%20%C3%97%20n%20%C3%97%20n%20array%20of%20unit%20cells.%22%22%22%0A%20%20%20%20%20%20%20%20xs%2C%20ys%2C%20zs%20%3D%20np.mgrid%5B0%3An%2C%200%3An%2C%200%3An%5D%0A%20%20%20%20%20%20%20%20pts%20%3D%20np.vstack((xs.ravel()%2C%20ys.ravel()%2C%20zs.ravel())).T%20*%20a%0A%20%20%20%20%20%20%20%20return%20pts%0A%0A%0A%20%20%20%20def%20generate_bcc(n%2C%20a%3D1.0)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Body-centred%20cubic%20lattice%3A%20SC%20%2B%20body%20centres.%22%22%22%0A%20%20%20%20%20%20%20%20sc%20%3D%20generate_sc(n%2C%20a)%0A%20%20%20%20%20%20%20%20centers%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20i%20in%20range(n)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20j%20in%20range(n)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20k%20in%20range(n)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20centers.append(np.array(%5Bi%20%2B%200.5%2C%20j%20%2B%200.5%2C%20k%20%2B%200.5%5D)%20*%20a)%0A%20%20%20%20%20%20%20%20centers%20%3D%20np.array(centers)%0A%20%20%20%20%20%20%20%20return%20np.vstack((sc%2C%20centers))%0A%0A%0A%20%20%20%20def%20generate_fcc(n%2C%20a%3D1.0)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Face-centred%20cubic%20lattice%3A%20SC%20%2B%20centres%20of%20each%20face.%22%22%22%0A%20%20%20%20%20%20%20%20sc%20%3D%20generate_sc(n%2C%20a)%0A%20%20%20%20%20%20%20%20shifts%20%3D%20np.array(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B0.5%2C%200.5%2C%200.0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B0.5%2C%200.0%2C%200.5%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B0.0%2C%200.5%2C%200.5%5D%2C%0A%20%20%20%20%20%20%20%20%5D)%0A%20%20%20%20%20%20%20%20faces%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20i%20in%20range(n)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20j%20in%20range(n)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20k%20in%20range(n)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20origin%20%3D%20np.array(%5Bi%2C%20j%2C%20k%5D%2C%20dtype%3Dfloat)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20s%20in%20shifts%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20faces.append((origin%20%2B%20s)%20*%20a)%0A%20%20%20%20%20%20%20%20faces%20%3D%20np.array(faces)%0A%20%20%20%20%20%20%20%20return%20np.vstack((sc%2C%20faces))%0A%0A%0A%20%20%20%20def%20generate_diamond(n%2C%20a%3D1.0)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Diamond%20structure%20%3D%20FCC%20Bravais%20lattice%20%2B%202-atom%20basis.%0A%0A%20%20%20%20%20%20%20%20Basis%20at%20(0%2C0%2C0)%20and%20(1%2F4%2C%201%2F4%2C%201%2F4).%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20fcc_pts%20%3D%20generate_fcc(n%2C%20a)%0A%20%20%20%20%20%20%20%20basis_shift%20%3D%20np.array(%5B0.25%2C%200.25%2C%200.25%5D)%20*%20a%0A%20%20%20%20%20%20%20%20diamond_pts%20%3D%20np.vstack((fcc_pts%2C%20fcc_pts%20%2B%20basis_shift))%0A%20%20%20%20%20%20%20%20return%20diamond_pts%0A%0A%0A%0A%20%20%20%20def%20get_atoms_on_plane(lattice_type%2C%20h%2C%20k%2C%20l%2C%20a%2C%20tol%3D1e-4)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Find%20atoms%20that%20lie%20on%20the%20Miller%20plane%20hx%20%2B%20ky%20%2B%20lz%20%3D%20a.%22%22%22%0A%20%20%20%20%20%20%20%20if%20lattice_type%20%3D%3D%20'SC'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20pts%20%3D%20generate_sc(3%2C%20a)%0A%20%20%20%20%20%20%20%20elif%20lattice_type%20%3D%3D%20'BCC'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20pts%20%3D%20generate_bcc(3%2C%20a)%0A%20%20%20%20%20%20%20%20elif%20lattice_type%20%3D%3D%20'FCC'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20pts%20%3D%20generate_fcc(3%2C%20a)%0A%20%20%20%20%20%20%20%20elif%20lattice_type%20%3D%3D%20'Diamond'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20pts%20%3D%20generate_diamond(3%2C%20a)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20pts%20%3D%20generate_sc(3%2C%20a)%0A%0A%20%20%20%20%20%20%20%20%23%20Plane%20equation%3A%20h*x%20%2B%20k*y%20%2B%20l*z%20%3D%20a%0A%20%20%20%20%20%20%20%20normal%20%3D%20np.array(%5Bh%2C%20k%2C%20l%5D%2C%20dtype%3Dfloat)%0A%20%20%20%20%20%20%20%20if%20np.linalg.norm(normal)%20%3C%201e-10%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20np.array(%5B%5D)%2C%200%0A%0A%20%20%20%20%20%20%20%20%23%20Find%20points%20on%20the%20plane%0A%20%20%20%20%20%20%20%20distances%20%3D%20np.abs(h%20*%20pts%5B%3A%2C%200%5D%20%2B%20k%20*%20pts%5B%3A%2C%201%5D%20%2B%20l%20*%20pts%5B%3A%2C%202%5D%20-%20a)%0A%20%20%20%20%20%20%20%20on_plane%20%3D%20pts%5Bdistances%20%3C%20tol%5D%0A%0A%20%20%20%20%20%20%20%20return%20on_plane%2C%20len(on_plane)%0A%0A%0A%20%20%20%20def%20get_areal_pf_calculation(lattice_type%2C%20h%2C%20k%2C%20l%2C%20a)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Return%20areal%20packing%20fraction%20with%20full%20calculation%20details.%0A%0A%20%20%20%20%20%20%20%20Returns%3A%20(apf_value%2C%20n_atoms%2C%20area_2d%2C%20r%2C%20area_formula%2C%20description)%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%23%20Normalize%20Miller%20indices%20to%20identify%20equivalent%20planes%0A%20%20%20%20%20%20%20%20indices%20%3D%20tuple(sorted(%5Babs(h)%2C%20abs(k)%2C%20abs(l)%5D%2C%20reverse%3DTrue))%0A%0A%20%20%20%20%20%20%20%20%23%20Get%20atomic%20radius%0A%20%20%20%20%20%20%20%20r%2C%20_%2C%20_%20%3D%20get_lattice_apf_info(lattice_type%2C%20a)%0A%20%20%20%20%20%20%20%20r_sq%20%3D%20r**2%0A%0A%20%20%20%20%20%20%20%20if%20lattice_type%20%3D%3D%20'SC'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20SC%3A%20r%20%3D%20a%2F2%2C%20r%C2%B2%20%3D%20a%C2%B2%2F4%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20indices%20%3D%3D%20(1%2C%200%2C%200)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20(100)%3A%20square%20a%20%C3%97%20a%2C%204%20corners%20%C3%97%201%2F4%20%3D%201%20atom%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20n_atoms%2C%20area_2d%20%3D%201%2C%20a**2%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20area_formula%20%3D%20%22a%C2%B2%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20desc%20%3D%20%22Square%20cell%20with%204%20corners%20%C3%97%20%C2%BC%22%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20indices%20%3D%3D%20(1%2C%201%2C%200)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20(110)%3A%20rectangle%20a%20%C3%97%20%E2%88%9A2%C2%B7a%2C%20atoms%20at%20corners%20and%20edge%20centers%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20n_atoms%2C%20area_2d%20%3D%201%2C%20np.sqrt(2)%20*%20a**2%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20area_formula%20%3D%20%22%E2%88%9A2%C2%B7a%C2%B2%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20desc%20%3D%20%22Rectangular%20cell%22%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20indices%20%3D%3D%20(1%2C%201%2C%201)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20(111)%3A%20hexagonal%20with%20NN%20%3D%20%E2%88%9A2%C2%B7a%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20n_atoms%2C%20area_2d%20%3D%201%2C%20np.sqrt(3)%20*%20a**2%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20area_formula%20%3D%20%22%E2%88%9A3%C2%B7a%C2%B2%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20desc%20%3D%20%22Hexagonal%20cell%2C%20NN%20distance%20%3D%20%E2%88%9A2%C2%B7a%22%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20None%2C%20None%2C%20None%2C%20r%2C%20None%2C%20None%0A%0A%20%20%20%20%20%20%20%20elif%20lattice_type%20%3D%3D%20'FCC'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20FCC%3A%20r%20%3D%20%E2%88%9A2%C2%B7a%2F4%2C%20r%C2%B2%20%3D%20a%C2%B2%2F8%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20indices%20%3D%3D%20(1%2C%201%2C%201)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20(111)%3A%20close-packed%20hexagonal%2C%20NN%20%3D%20a%2F%E2%88%9A2%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Primitive%20cell%20area%20%3D%20(%E2%88%9A3%2F2)%20%C3%97%20(a%2F%E2%88%9A2)%C2%B2%20%3D%20%E2%88%9A3%C2%B7a%C2%B2%2F4%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20n_atoms%2C%20area_2d%20%3D%201%2C%20np.sqrt(3)%20*%20a**2%20%2F%204%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20area_formula%20%3D%20%22%E2%88%9A3%C2%B7a%C2%B2%2F4%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20desc%20%3D%20%22Close-packed%20hexagonal%2C%20NN%20%3D%20a%2F%E2%88%9A2%22%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20indices%20%3D%3D%20(1%2C%200%2C%200)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20(100)%3A%20square%20a%20%C3%97%20a%2C%204%20corners%20%C3%97%201%2F4%20%2B%201%20face%20center%20%3D%202%20atoms%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20n_atoms%2C%20area_2d%20%3D%202%2C%20a**2%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20area_formula%20%3D%20%22a%C2%B2%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20desc%20%3D%20%22Square%20cell%3A%204%20corners%20%C3%97%20%C2%BC%20%2B%201%20center%22%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20indices%20%3D%3D%20(1%2C%201%2C%200)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20(110)%3A%20rectangle%20a%20%C3%97%20%E2%88%9A2%C2%B7a%2C%204%20corners%20%C3%97%201%2F4%20%2B%202%20edges%20%C3%97%201%2F2%20%3D%202%20atoms%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20n_atoms%2C%20area_2d%20%3D%202%2C%20np.sqrt(2)%20*%20a**2%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20area_formula%20%3D%20%22%E2%88%9A2%C2%B7a%C2%B2%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20desc%20%3D%20%22Rectangular%20cell%3A%204%20corners%20%C3%97%20%C2%BC%20%2B%202%20edges%20%C3%97%20%C2%BD%22%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20None%2C%20None%2C%20None%2C%20r%2C%20None%2C%20None%0A%0A%20%20%20%20%20%20%20%20elif%20lattice_type%20%3D%3D%20'BCC'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20BCC%3A%20r%20%3D%20%E2%88%9A3%C2%B7a%2F4%2C%20r%C2%B2%20%3D%203a%C2%B2%2F16%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20indices%20%3D%3D%20(1%2C%201%2C%200)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20(110)%3A%20close-packed%20for%20BCC%2C%20rectangle%20a%20%C3%97%20%E2%88%9A2%C2%B7a%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%204%20corners%20%C3%97%201%2F4%20%2B%201%20center%20%3D%202%20atoms%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20n_atoms%2C%20area_2d%20%3D%202%2C%20np.sqrt(2)%20*%20a**2%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20area_formula%20%3D%20%22%E2%88%9A2%C2%B7a%C2%B2%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20desc%20%3D%20%22Close-packed%20for%20BCC%3A%204%20corners%20%C3%97%20%C2%BC%20%2B%201%20center%22%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20indices%20%3D%3D%20(1%2C%200%2C%200)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20(100)%3A%20square%20a%20%C3%97%20a%2C%20only%20corner%20atoms%20(body%20center%20on%20different%20plane)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%204%20corners%20%C3%97%201%2F4%20%3D%201%20atom%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20n_atoms%2C%20area_2d%20%3D%201%2C%20a**2%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20area_formula%20%3D%20%22a%C2%B2%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20desc%20%3D%20%22Square%20cell%3A%204%20corners%20%C3%97%20%C2%BC%20(body%20centers%20on%20different%20plane)%22%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20indices%20%3D%3D%20(1%2C%201%2C%201)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20(111)%3A%20only%20SC%20sublattice%20atoms%20(body%20centers%20on%20different%20planes)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Hexagonal%20with%20NN%20%3D%20%E2%88%9A2%C2%B7a%2C%20area%20%3D%20%E2%88%9A3%C2%B7a%C2%B2%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20n_atoms%2C%20area_2d%20%3D%201%2C%20np.sqrt(3)%20*%20a**2%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20area_formula%20%3D%20%22%E2%88%9A3%C2%B7a%C2%B2%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20desc%20%3D%20%22Hexagonal%20(SC%20sublattice%20only)%2C%20NN%20%3D%20%E2%88%9A2%C2%B7a%22%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20None%2C%20None%2C%20None%2C%20r%2C%20None%2C%20None%0A%0A%20%20%20%20%20%20%20%20elif%20lattice_type%20%3D%3D%20'Diamond'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Diamond%3A%20r%20%3D%20%E2%88%9A3%C2%B7a%2F8%2C%20r%C2%B2%20%3D%203a%C2%B2%2F64%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20indices%20%3D%3D%20(1%2C%201%2C%201)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20(111)%3A%20Two%20interlocking%20triangular%20sublattices%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%202%20atoms%20per%20FCC%20primitive%20cell%20area%20%3D%20%E2%88%9A3%C2%B7a%C2%B2%2F4%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20n_atoms%2C%20area_2d%20%3D%202%2C%20np.sqrt(3)%20*%20a**2%20%2F%204%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20area_formula%20%3D%20%22%E2%88%9A3%C2%B7a%C2%B2%2F4%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20desc%20%3D%20%222%20atoms%20per%20hexagonal%20cell%20(FCC%20%2B%20basis)%22%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20indices%20%3D%3D%20(1%2C%200%2C%200)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20(100)%3A%204%20atoms%20per%20a%C2%B2%20(2%20FCC%20%2B%202%20basis%20atoms%20visible)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20n_atoms%2C%20area_2d%20%3D%204%2C%20a**2%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20area_formula%20%3D%20%22a%C2%B2%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20desc%20%3D%20%22Square%20cell%3A%204%20atoms%20(FCC%20%2B%20basis%20layers)%22%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20indices%20%3D%3D%20(1%2C%201%2C%200)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20(110)%3A%20rectangular%20cell%20with%20zigzag%20chains%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20n_atoms%2C%20area_2d%20%3D%204%2C%20np.sqrt(2)%20*%20a**2%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20area_formula%20%3D%20%22%E2%88%9A2%C2%B7a%C2%B2%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20desc%20%3D%20%22Rectangular%20cell%20with%20zigzag%20chains%22%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20None%2C%20None%2C%20None%2C%20r%2C%20None%2C%20None%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20None%2C%20None%2C%20None%2C%20r%2C%20None%2C%20None%0A%0A%20%20%20%20%20%20%20%20%23%20Calculate%20APF%0A%20%20%20%20%20%20%20%20apf%20%3D%20n_atoms%20*%20np.pi%20*%20r_sq%20%2F%20area_2d%0A%0A%20%20%20%20%20%20%20%20return%20apf%2C%20n_atoms%2C%20area_2d%2C%20r%2C%20area_formula%2C%20desc%0A%0A%0A%20%20%20%20def%20_get_plane_basis_vectors(h%2C%20k%2C%20l)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Get%20two%20orthonormal%20basis%20vectors%20that%20lie%20in%20the%20plane%20(hkl).%22%22%22%0A%20%20%20%20%20%20%20%20normal%20%3D%20np.array(%5Bh%2C%20k%2C%20l%5D%2C%20dtype%3Dfloat)%0A%20%20%20%20%20%20%20%20normal%20%3D%20normal%20%2F%20np.linalg.norm(normal)%0A%0A%20%20%20%20%20%20%20%20%23%20Find%20a%20vector%20not%20parallel%20to%20normal%0A%20%20%20%20%20%20%20%20if%20abs(normal%5B0%5D)%20%3C%200.9%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20temp%20%3D%20np.array(%5B1%2C%200%2C%200%5D)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20temp%20%3D%20np.array(%5B0%2C%201%2C%200%5D)%0A%0A%20%20%20%20%20%20%20%20%23%20First%20basis%20vector%20(in%20plane)%0A%20%20%20%20%20%20%20%20u%20%3D%20np.cross(normal%2C%20temp)%0A%20%20%20%20%20%20%20%20u%20%3D%20u%20%2F%20np.linalg.norm(u)%0A%0A%20%20%20%20%20%20%20%20%23%20Second%20basis%20vector%20(in%20plane%2C%20perpendicular%20to%20u)%0A%20%20%20%20%20%20%20%20v%20%3D%20np.cross(normal%2C%20u)%0A%20%20%20%20%20%20%20%20v%20%3D%20v%20%2F%20np.linalg.norm(v)%0A%0A%20%20%20%20%20%20%20%20return%20u%2C%20v%0A%0A%0A%20%20%20%20def%20_draw_circle_on_plane(ax%2C%20center%2C%20radius%2C%20h%2C%20k%2C%20l%2C%20n_points%3D50%2C%20**kwargs)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Draw%20a%20circle%20on%20the%20plane%20(hkl)%20centered%20at%20the%20given%20point.%22%22%22%0A%20%20%20%20%20%20%20%20u%2C%20v%20%3D%20_get_plane_basis_vectors(h%2C%20k%2C%20l)%0A%0A%20%20%20%20%20%20%20%20%23%20Generate%20circle%20points%0A%20%20%20%20%20%20%20%20theta%20%3D%20np.linspace(0%2C%202%20*%20np.pi%2C%20n_points)%0A%20%20%20%20%20%20%20%20circle_pts%20%3D%20np.array(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20center%20%2B%20radius%20*%20(np.cos(t)%20*%20u%20%2B%20np.sin(t)%20*%20v)%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20t%20in%20theta%0A%20%20%20%20%20%20%20%20%5D)%0A%0A%20%20%20%20%20%20%20%20ax.plot(circle_pts%5B%3A%2C%200%5D%2C%20circle_pts%5B%3A%2C%201%5D%2C%20circle_pts%5B%3A%2C%202%5D%2C%20**kwargs)%0A%0A%0A%20%20%20%20def%20plot_areal_packing(lattice_type%3D'SC'%2C%20h%3D1%2C%20k%3D0%2C%20l%3D0%2C%20a%3D1.0)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Visualize%20atoms%20on%20a%20Miller%20plane%20and%20show%20areal%20packing%20fraction%20calculation.%22%22%22%0A%20%20%20%20%20%20%20%20import%20plotly.graph_objects%20as%20go%0A%0A%20%20%20%20%20%20%20%20if%20h%20%3D%3D%200%20and%20k%20%3D%3D%200%20and%20l%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20mo.md(%22**Invalid%20Miller%20indices%20(0%2C0%2C0)**%22)%0A%0A%20%20%20%20%20%20%20%20%23%20Get%20atomic%20radius%20for%20this%20lattice%0A%20%20%20%20%20%20%20%20r%2C%20_%2C%20_%20%3D%20get_lattice_apf_info(lattice_type%2C%20a)%0A%0A%20%20%20%20%20%20%20%20%23%20Get%20plane%20intersection%20polygon%0A%20%20%20%20%20%20%20%20plane_pts%20%3D%20get_plane_cell_intersection(h%2C%20k%2C%20l%2C%20a)%0A%0A%20%20%20%20%20%20%20%20if%20len(plane_pts)%20%3C%203%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20mo.md(f%22**Plane%20(%7Bh%7D%7Bk%7D%7Bl%7D)%20does%20not%20intersect%20the%20unit%20cell%20properly.**%22)%0A%0A%20%20%20%20%20%20%20%20%23%20Get%20atoms%20on%20the%20plane%0A%20%20%20%20%20%20%20%20atoms_on_plane%2C%20n_atoms_found%20%3D%20get_atoms_on_plane(lattice_type%2C%20h%2C%20k%2C%20l%2C%20a)%0A%0A%20%20%20%20%20%20%20%20%23%20Get%20areal%20packing%20fraction%20calculation%0A%20%20%20%20%20%20%20%20apf%2C%20n_atoms%2C%20area_2d%2C%20r_calc%2C%20area_formula%2C%20desc%20%3D%20get_areal_pf_calculation(lattice_type%2C%20h%2C%20k%2C%20l%2C%20a)%0A%0A%20%20%20%20%20%20%20%20if%20apf%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20mo.md(f%22**Areal%20packing%20fraction%20not%20available%20for%20%7Blattice_type%7D%20(%7Bh%7D%7Bk%7D%7Bl%7D)**%22)%0A%0A%20%20%20%20%20%20%20%20%23%20Create%20Plotly%20figure%0A%20%20%20%20%20%20%20%20fig%20%3D%20go.Figure()%0A%0A%20%20%20%20%20%20%20%20%23%20Draw%20unit%20cell%20edges%0A%20%20%20%20%20%20%20%20edges%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20(%5B0%2C%20a%5D%2C%20%5B0%2C%200%5D%2C%20%5B0%2C%200%5D)%2C%20(%5B0%2C%200%5D%2C%20%5B0%2C%20a%5D%2C%20%5B0%2C%200%5D)%2C%20(%5B0%2C%200%5D%2C%20%5B0%2C%200%5D%2C%20%5B0%2C%20a%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(%5Ba%2C%20a%5D%2C%20%5B0%2C%20a%5D%2C%20%5B0%2C%200%5D)%2C%20(%5Ba%2C%20a%5D%2C%20%5B0%2C%200%5D%2C%20%5B0%2C%20a%5D)%2C%20(%5B0%2C%20a%5D%2C%20%5Ba%2C%20a%5D%2C%20%5B0%2C%200%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(%5B0%2C%200%5D%2C%20%5Ba%2C%20a%5D%2C%20%5B0%2C%20a%5D)%2C%20(%5B0%2C%20a%5D%2C%20%5B0%2C%200%5D%2C%20%5Ba%2C%20a%5D)%2C%20(%5B0%2C%200%5D%2C%20%5B0%2C%20a%5D%2C%20%5Ba%2C%20a%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(%5Ba%2C%20a%5D%2C%20%5Ba%2C%20a%5D%2C%20%5B0%2C%20a%5D)%2C%20(%5Ba%2C%20a%5D%2C%20%5B0%2C%20a%5D%2C%20%5Ba%2C%20a%5D)%2C%20(%5B0%2C%20a%5D%2C%20%5Ba%2C%20a%5D%2C%20%5Ba%2C%20a%5D)%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20for%20edge%20in%20edges%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20fig.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dedge%5B0%5D%2C%20y%3Dedge%5B1%5D%2C%20z%3Dedge%5B2%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(color%3D'black'%2C%20width%3D2)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20hoverinfo%3D'skip'%0A%20%20%20%20%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20%23%20Draw%20the%20plane%20polygon%20using%20Mesh3d%0A%20%20%20%20%20%20%20%20if%20len(plane_pts)%20%3E%3D%203%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Create%20triangulation%20for%20the%20polygon%0A%20%20%20%20%20%20%20%20%20%20%20%20n_pts%20%3D%20len(plane_pts)%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Fan%20triangulation%20from%20first%20vertex%0A%20%20%20%20%20%20%20%20%20%20%20%20i_indices%20%3D%20%5B0%5D%20*%20(n_pts%20-%202)%0A%20%20%20%20%20%20%20%20%20%20%20%20j_indices%20%3D%20list(range(1%2C%20n_pts%20-%201))%0A%20%20%20%20%20%20%20%20%20%20%20%20k_indices%20%3D%20list(range(2%2C%20n_pts))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20fig.add_trace(go.Mesh3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dplane_pts%5B%3A%2C%200%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dplane_pts%5B%3A%2C%201%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3Dplane_pts%5B%3A%2C%202%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20i%3Di_indices%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20j%3Dj_indices%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20k%3Dk_indices%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3D'cyan'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20opacity%3D0.4%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3Df'(%7Bh%7D%7Bk%7D%7Bl%7D)%20plane'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DTrue%0A%20%20%20%20%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Draw%20plane%20edges%0A%20%20%20%20%20%20%20%20%20%20%20%20closed_pts%20%3D%20np.vstack(%5Bplane_pts%2C%20plane_pts%5B0%5D%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20fig.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dclosed_pts%5B%3A%2C%200%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dclosed_pts%5B%3A%2C%201%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3Dclosed_pts%5B%3A%2C%202%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(color%3D'darkblue'%2C%20width%3D4)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20hoverinfo%3D'skip'%0A%20%20%20%20%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20%23%20Draw%20atoms%20on%20the%20plane%0A%20%20%20%20%20%20%20%20if%20len(atoms_on_plane)%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20fig.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Datoms_on_plane%5B%3A%2C%200%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Datoms_on_plane%5B%3A%2C%201%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3Datoms_on_plane%5B%3A%2C%202%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'markers'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker%3Ddict(size%3D12%2C%20color%3D'steelblue'%2C%20line%3Ddict(color%3D'navy'%2C%20width%3D2))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3D'Atoms%20on%20plane'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DTrue%0A%20%20%20%20%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Draw%20circles%20representing%20atomic%20radius%20on%20the%20plane%0A%20%20%20%20%20%20%20%20%20%20%20%20u%2C%20v%20%3D%20_get_plane_basis_vectors(h%2C%20k%2C%20l)%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20atom%20in%20atoms_on_plane%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20theta%20%3D%20np.linspace(0%2C%202%20*%20np.pi%2C%2050)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20circle_pts%20%3D%20np.array(%5Batom%20%2B%20r%20*%20(np.cos(t)%20*%20u%20%2B%20np.sin(t)%20*%20v)%20for%20t%20in%20theta%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fig.add_trace(go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dcircle_pts%5B%3A%2C%200%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dcircle_pts%5B%3A%2C%201%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3Dcircle_pts%5B%3A%2C%202%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(color%3D'blue'%2C%20width%3D3)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20hoverinfo%3D'skip'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20%23%20Update%20layout%0A%20%20%20%20%20%20%20%20fig.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%3Df'%7Blattice_type%7D%20-%20Plane%20(%7Bh%7D%7Bk%7D%7Bl%7D)%3Cbr%3E%3Csub%3EAreal%20Packing%20Fraction%20%3D%20%7Bapf*100%3A.1f%7D%25%20%7C%20Drag%20to%20rotate%3C%2Fsub%3E'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D0.5%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scene%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xaxis_title%3D'x%20%5Ba%5D'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yaxis_title%3D'y%20%5Ba%5D'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zaxis_title%3D'z%20%5Ba%5D'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20aspectmode%3D'cube'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20camera%3Ddict(eye%3Ddict(x%3D1.8%2C%20y%3D1.8%2C%20z%3D1.2))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xaxis%3Ddict(range%3D%5B-0.2%2C%20a%20%2B%200.5%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yaxis%3Ddict(range%3D%5B-0.2%2C%20a%20%2B%200.5%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zaxis%3Ddict(range%3D%5B-0.2%2C%20a%20%2B%200.5%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D600%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D800%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3Ddict(l%3D0%2C%20r%3D0%2C%20t%3D80%2C%20b%3D0)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20legend%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yanchor%3D%22top%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D0.99%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xanchor%3D%22left%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D0.01%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20Create%20calculation%20summary%0A%20%20%20%20%20%20%20%20calc_text%20%3D%20f%22%22%22%0A%20%20%20%20**Calculation%20for%20%7Blattice_type%7D%20(%7Bh%7D%7Bk%7D%7Bl%7D)%3A**%0A%0A%20%20%20%20-%20**Description%3A**%20%7Bdesc%7D%0A%20%20%20%20-%20**Atomic%20radius%3A**%20r%20%3D%20%7Br_calc%3A.4f%7Da%0A%20%20%20%20-%20**Atoms%20per%202D%20cell%3A**%20n%20%3D%20%7Bn_atoms%7D%0A%20%20%20%20-%20**2D%20cell%20area%3A**%20A%20%3D%20%7Barea_formula%7D%20%3D%20%7Barea_2d%3A.4f%7Da%C2%B2%0A%20%20%20%20-%20**Areal%20PF%3A**%20n%20%C3%97%20%CF%80r%C2%B2%20%2F%20A%20%3D%20%7Bn_atoms%7D%20%C3%97%20%CF%80%20%C3%97%20(%7Br_calc%3A.4f%7D)%C2%B2%20%2F%20%7Barea_2d%3A.4f%7D%20%3D%20**%7Bapf*100%3A.1f%7D%25**%0A%20%20%20%20%22%22%22%0A%0A%20%20%20%20%20%20%20%20return%20mo.vstack(%5Bfig%2C%20mo.md(calc_text)%5D%2C%20align%3D%22center%22)%0A%0A%20%20%20%20lattice_type_dropdown2%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20options%3D%5B'SC'%2C%20'BCC'%2C%20'FCC'%2C%20'Diamond'%5D%2C%0A%20%20%20%20%20%20%20%20value%3D'FCC'%2C%0A%20%20%20%20%20%20%20%20label%3D'Lattice%20Type'%0A%20%20%20%20)%0A%0A%20%20%20%20h_slider2%20%3D%20mo.ui.slider(start%3D0%2C%20stop%3D1%2C%20step%3D1%2C%20value%3D1%2C%20label%3D%22h%22)%0A%20%20%20%20k_slider2%20%3D%20mo.ui.slider(start%3D0%2C%20stop%3D1%2C%20step%3D1%2C%20value%3D1%2C%20label%3D%22k%22)%0A%20%20%20%20l_slider2%20%3D%20mo.ui.slider(start%3D0%2C%20stop%3D1%2C%20step%3D1%2C%20value%3D1%2C%20label%3D%22l%22)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20h_slider2%2C%0A%20%20%20%20%20%20%20%20k_slider2%2C%0A%20%20%20%20%20%20%20%20l_slider2%2C%0A%20%20%20%20%20%20%20%20lattice_type_dropdown2%2C%0A%20%20%20%20%20%20%20%20plot_areal_packing%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20h_slider2%2C%0A%20%20%20%20k_slider2%2C%0A%20%20%20%20l_slider2%2C%0A%20%20%20%20lattice_type_dropdown2%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20plot_areal_packing%2C%0A)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%2010.1%20Planar%20Packing%20Fraction%20Visualization%22)%2C%0A%20%20%20%20%20%20%20%20mo.hstack(%5Blattice_type_dropdown2%2C%20h_slider2%2C%20k_slider2%2C%20l_slider2%5D%2C%20justify%3D%22start%22%2C%20gap%3D2)%2C%0A%20%20%20%20%20%20%20%20plot_areal_packing(%0A%20%20%20%20%20%20%20%20%20%20%20%20lattice_type%3Dlattice_type_dropdown2.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20h%3Dh_slider2.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20k%3Dk_slider2.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20l%3Dl_slider2.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20a%3D1.0%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%5D%2C%20align%3D%22center%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(IMAGE_DIR%2C%20mo)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%2011.%20Wafers%20and%20Wafer%20Flats%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20-%20Silicon%20wafers%20have%20specific%20orientations%20marked%20by%20**flats**%20or%20**notches**%3A%0A%20%20%20%20%20%20%20%20-%20**Primary%20flat%20(or%20notch)**%3A%20Longer%20flat%20edge%20along%20%5B011%5D%20direction%0A%20%20%20%20%20%20%20%20-%20**Secondary%20flat**%3A%20Shorter%20flat%20edge%0A%20%20%20%20-%20The%20wafer%20orientation%20affects%20carrier%20mobility%2C%20etch%20rates%2C%20defect%20densities%2C%20etc.%0A%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.image(src%3DIMAGE_DIR%20%2F%20%22wafer_flats.jpg%22%2C%20width%3D%2260%25%22)%0A%20%20%20%20%20%20%20%20%5D%2C%20justify%3D%22start%22%2C%20%20gap%3D2)%0A%20%20%20%20%5D)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A</marimo-code></head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "notebook.py",
            "mode": "read",
            "version": "0.18.4",
            "serverToken": "unused",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "off", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": false},
            "notebook": null,
            "session": null,
            "runtimeConfig": null,
        };
    </script>
  </body>
</html>
